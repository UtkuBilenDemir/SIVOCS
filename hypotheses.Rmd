---
title: "19_hypotheses"
output:
  html_document:
    df_print: paged
    self_contained: false
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
library(likert)
library(dplyr)
library(plyr)
library(tidyverse)

source("./02_analysis/02_static_responses.R")
# colnames of the specific question groups
source("./02_analysis/99_question_groups.R")

knitr::opts_chunk$set(fig.retina=2,
                      echo=FALSE,
                      dev='svg'
                      )

# Settings
g_tick_size_main <- 14
g_tick_size_side <- 12


#----------- Variable Names
# B1: SI-Familiarity
# WT: Wilcoxon

```

# Familiarity with SI and Transdisciplinarity

```{r echo=FALSE, fig.align='center', fig.height=4, fig.retina=2, fig.width=12, message=FALSE, warning=FALSE, dev='svg', include=TRUE}

a1b1c2 <- as.data.frame(cbind(
  data[, a1.colnames],
  data$familiarWithSI.response.,
  data$contribToSI.rate.
))

names(a1b1c2) <- c(
  V1 = "Experience with transdisciplinary research",
  V2 = "Familiarity with the concept of 'social innovation'",
  V3 = "Project's contribution to social innovation"
)

#likert_recode(a1b1c2)
items_likert <- 
  #round(d1.df) %>%
  a1b1c2 %>%
  mutate_all(likert_recode) %>%
  #likert(grouping=data$domain)
  likert()

likert_plot(items_likert, h=FALSE, c=c(1,3,5)) + theme( axis.text.y = element_text( 
                         size=g_tick_size_main), axis.text.x = element_text(
                         size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) 
  #scale_fill_discrete(name = "")
#c("#CA0020", "#F4A582", "#DFDFDF", "#92C5DE", "#92C5DE")

```


## Distribution of SI-Familiarity

```{r}
a <- as.data.frame(table(data.questions$familiarWithSI.response.))

ggplot(data=a, aes(x=Var1, y=Freq)) +
  geom_bar(stat="identity")

```
> TODO: Description of B1


```{r echo=FALSE}
b1.shapiro <- shapiro.test(data$familiarWithSI.response.)
b1.barlett <- bartlett.test(data=data, familiarWithSI.response. ~ domain)
b1.kruswal <- kruskal.test(data=data, familiarWithSI.response. ~ domain)
b1.pwilcox <- pairwise.wilcox.test(data$familiarWithSI.response.,
                                   data$domain,
                                   mu = 0,
                                   alt = "two.sided",
                                   conf.int = T,
                                   conf.level = 0.95,
                                   paired = F,
                                   correct = T,
                                   p.adjust="bonferroni" )

```

The majority of the respondents indicated their low familiarity with SI, approximately %32 of the respondents selected the lowest level of SI familiarity (indicated with 0) and only %16 percent of the respondents selected a value equal or greater than 7. 

One of the literature-driven assumptions about the SI-familiarity was that [H] *the SI-Familiarity depends on the scientific domain*. The hypothesis is motivated by the wide-spread perspective especially on the SSH fields to be more aware of the SI aspect in research. 

The results of the study shows a statistically significant difference between the 3 main scientific domains in the SNF funded projects (Kruskal-Wallis [K-W] rank sum test p-value < 0.05). However, the domains Mathemics, Natural, & Engineering Sciences and Biology & Medicine are stat. not significantly different from each other ()

as Figure \@ref(type:B1-boxplot) visualises the pairwise differences (pairwise Wilcoxon Test (WT), p-value > 0.05). However SSH Domain shows a significant 






# B1 (NEW): Kruskal-Wallis test: SI familiarity depends on sci. domains?



* Mean ranks of the groups are not the same, SI fam. depends on domain



---

# B1: *Familiarity with SI* across scientific domains

<br>

```{r B1-boxplot, echo=FALSE, fig.width=12, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
b1domain.df <-data.frame(familiarWithSI = data$familiarWithSI.response.,
                         domain =  data$domain)

b1domain.df$familiarWithSI <- as.numeric(b1domain.df$familiarWithSI)
b1domain.df %>% 
  gather(key="domain", value="familiarWithSI") %>%
  ggplot( aes(x=familiarWithSI, y=domain, fill=domain),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ")+
  theme_light() + 
  theme(axis.text.y=element_blank())+ scale_fill_discrete(name = "Domain") + xlab("Familiarity with SI") + scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Domain") +
  scale_x_continuous(breaks = seq(0,10,2))  

```
<br>
<br>

* *Familiarity with SI* differs across scientific domains (Kruskal-Wallis p-value < 0.05)
* *Biology and Medicine* and *Math., Natur, and Eng. Sci.* are **not** stat. significantly different (pairwise Wilcoxon p-value > 0.05)

* *Humanities and Social Sciences* are significantly different than the others (pairwise t-test with each: p < 0.05)



















---

# Notes

* Considering most of the variables are not normally distributed non parametric tests are returning statistically more robust outcomes. 