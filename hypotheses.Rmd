---
title: "19_hypotheses"
output:
  html_document:
    df_print: paged
    self_contained: false
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
rm(list=ls()) 
library(likert)
library(dplyr)
library(plyr)
library(tidyverse)
library(patchwork)
library(psych)
library(flextable)
library(EnvStats)

source("./02_analysis/02_static_responses.R")
# colnames of the specific question groups
source("./02_analysis/99_question_groups.R")

knitr::opts_chunk$set(fig.retina=2,
                      echo=FALSE,
                      dev='svg'
)

# Settings
g_tick_size_main <- 14
g_tick_size_side <- 12


#----------- Variable Names
# B1: SI-Familiarity
# WT: Wilcoxon

# ----------- TODO
# TODO: Find consistent colorschemes

corr_boxplot <- function(df, V1, V2 ) {
  out_plot <- df %>% 
    filter(!is.na(V1)) %>%
    gather(key=V2, value=V1) %>%
    ggplot( aes(x=V2, y=V1, fill=V1),  show.legend = FALSE) +
    geom_boxplot() +
    ylab(" ")+
    theme_light() + 
    theme(axis.text.y=element_blank())
  
  return(out_plot)
}


col_div <- c("#d53e4f",
             "#fc8d59",
             "#fee08b",
             "#e6f598",
             "#99d594",
             "#3288bd")

# col_seq <- col_div[(length(col_div) - 2):length(col_div)]

# col_seq <- c("#d1e5f0",
# "#4393c3",
# "#053061")

# 10 Color sequential
#67001f
#b2182b
#d6604d
#f4a582
#fddbc7
#d1e5f0
#92c5de
#4393c3
#2166ac
#053061

col_seq <- c("#f4a582",
             "#92c5de",
             "#2166ac")

col_seq4 <- c("#b2182b",
              "#f4a582",
              "#92c5de",
              "#2166ac")
col_seq5 <- c(
  "#ca0020",
  "#f4a582",
  "#f7f7f7",
  "#92c5de",
  "#0571b0"
)


col_seq5_alt <- c(
  "#d1e5f0",
  "#92c5de",
  "#4393c3",
  "#2166ac",
  "#053061"
)

col_bar <- "#4393c3"
col_bar2 <- "#b2182b"

col_dom <- c("#FC4E07", "#E7B800", "#00AFBB")

```

# Familiarity with SI and Transdisciplinarity

<!-- TODO: Describe the importance --> 
<!-- TODO: Mention SI as the abbr. of social innocation--> 

```{r FamTrans, echo=FALSE, fig.align='center', fig.height=4, fig.retina=2, fig.width=12, message=FALSE, warning=FALSE, include=TRUE}

a1b1c2 <- as.data.frame(cbind(
  data[, a1.colnames],
  data$familiarWithSI.response.,
  data$contribToSI.rate.
))
sum(!is.na(a1b1c2$`Project's contribution to social innovation`))
names(a1b1c2) <- c(
  V1 = "Experience with transdisciplinary research",
  V2 = "Familiarity with the concept of 'social innovation'",
  V3 = "Project's contribution to social innovation"
)

#likert_recode(a1b1c2)
items_likert <- 
  #round(d1.df) %>%
  a1b1c2 %>%
  mutate_all(likert_recode) %>%
  #likert(grouping=data$domain)
  likert()

likert_plot(items_likert, h=FALSE, c=c(1,3,5)) + theme( axis.text.y = element_text( 
  size=g_tick_size_main), axis.text.x = element_text(
    size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) +
  annotate("label", x = 3, y = -100, label = "bold(n) == 352/361", parse = TRUE) +
  annotate("label", x = 2, y = -100, label = "bold(n) == 360/361", parse = TRUE) +
  annotate("label", x = 1, y = -100, label = "bold(n) == 112/361", parse = TRUE) 

```

## A1: Experience with transdisciplinary Research

<!-- TODO: Informative paragraph about transdisciplinary methods (Literature research, reflections from the research team) -->
<!-- TODO: Decide if we should name the hypotheses explicitly in their own paragraphs bullet-point wise -->
The majority of the survey respondents are somewhat experienced in transdisciplinary research approaches, only 26% of the respondents rated their transdisciplinary experience lower than or equal to 3 on a scale of 1 - 10. Close to half of all survey respondents (46%) note their especially high levels of experience in transdisciplinary methods.
Transdisciplinarity is not a condition for SI, however, it is usually an important cornerstone in the setting of socially innovative outcomes. Transdisciplinary experience of the researchers does not directly implicate higher chances for social innovation in the research project but (H) *we assume that it is often in relation with not (purely) academic motivation to conduct research*. 

```{r A1-table}

a1_q <- "How would you rate your experience with transdisciplinary research?"

a1_table_df <- data.frame(Answer = c(
  "0..not experienced at all", 1:9, "10..highly experienced", "No answer", "Not completed","Total(gross)" 
),

Count = c(19,
          18,                      
          27,                      
          35,                      
          22,                      
          40,                      
          33,
          61,
          41,
          31,
          47,
          14,
          12,
          400),

Percentage = c("4.75%",
               "4.50%",
               "6.75%",
               "8.75%",
               "5.50%",
               "10.00%",
               "8.25%",
               "15.25%",
               "10.25%",
               "7.75%",
               "11.75%",
               "3.50%",
               "3.00%",
               "100.00%"
)

) 

myft <- flextable(a1_table_df
                  #col_keys = c("Answer",	"Count",	"Gross percentage")
)
myft <- add_header_row(
  x = myft, values = c("How would you rate your experience with transdisciplinary research?"),
  colwidths = c(3))

myft <- theme_vanilla(myft)
myft <- align(myft, j=3, align = "right", part = "all")
myft <- set_table_properties(myft, layout = "autofit")
print(myft, preview = "docx")
myft
```


```{r A1_bar, echo=FALSE, fig.width=8, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}

age <- factor(data.questions$age)
levels(age) <- c(NA, "< 39", "40ies", "50ies", "60ies", "> 70")

a <- as.data.frame(table(data.questions$transdisciplinaryExp.rate.))
c <-  data.frame(t = data.questions$transdisciplinaryExp.rate.,
                 #    d = meta_df$domain
                 d = age
)
c1 <- as.data.frame(table(c))

n <- sum(!is.na(data.questions$transdisciplinaryExp.rate.))
no <- length(data.questions$transdisciplinaryExp.rate.)
ggplot(data=c1, aes(x=t, y=Freq, fill = d)) +
  theme_light() +
  geom_bar(stat="identity") +
  xlab("Transdisciplinary Experience") +
  ylab("Count") + 
  scale_fill_manual("Age", values = col_seq5_alt) + 
  theme(legend.position="top") + 
  annotate("label", x = 1.5, y = 55, label = "bold(n) == 352/361", parse = TRUE)

```



```{r A1-boxplot, echo=FALSE, fig.width=10, fig.height=3, dev='svg', fig.retina=2, fig.align='center'}
ad_df <- as.data.frame(cbind(
  a1 = feat_df.num$transdisciplinaryExp.rate.,
  d12 = feat_df.num$motivation.prob.,
  d13 = feat_df.num$motivation.welfare.
))

ad_df$a1 <- likert_recode(ad_df$a1)

# TODO: Interpret the correlations
cor(feat_df.num$transdisciplinaryExp.rate., ad_df$d13, method = "spearman", use = "pairwise.complete.obs")
cor(feat_df.num$transdisciplinaryExp.rate., ad_df$d12, method = "spearman", use = "pairwise.complete.obs")

a11_boxplot <- ad_df[, c(1,2)] %>% 
  filter(!is.na(a1)) %>%
  gather(key="d12", value="a1") %>%
  ggplot(aes(x=d12, y=a1, fill=a1),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  xlab("Motivation to address a non-academic problem") + 
  # scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), 
  # scale_fill_manual(values=col_seq[(length(col_seq) -2):length(col_seq) ], 
  scale_fill_manual(values=col_seq, 
                    name="Transdisciplinary Experience") +
  
  theme(axis.text.y=element_blank(), legend.position = "none") +
  
  scale_x_continuous(breaks = seq(0,10,2))  


a12_boxplot <- ad_df[, c(1,3)] %>% 
  filter(!is.na(a1)) %>%
  gather(key="d13", value="a1") %>%
  ggplot(aes(x=d13, y=a1, fill=a1)) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y=element_blank()) +
  xlab("Motivation to improve human condition") + 
  scale_fill_manual(values=col_seq, name="Transdisciplinary Experience") +
  scale_x_continuous(breaks = seq(0,10,2)) +
  # Reverse the legend
  guides(fill = guide_legend(reverse = TRUE))

a11_boxplot + a12_boxplot

```

```{r }
library(Hmisc)
rcorr(as.matrix(as.data.frame(cbind(
  Trans._Exp. =feat_df.num$transdisciplinaryExp.rate., 
  Mot._to_add_Pr. = ad_df$d12, 
  Mot._to_imp._HC = ad_df$d13))), type = "spearman")
```


The survey questions *motivation to directly address a natural, technical, economic, or social problem* and to improve the human condition/welfare are directed to the measure non- or only partially academic motivation. The analysis of the relation between the rate of transdisciplinary experience and the motivation to address a (non-academic) problem (see Figure 2) does not yield any significant correlation between the variables (correlation coefficient rho  ~0.01), to be motivated to address the natural, technical, economic, or social problem directly does not seem to be getting higher with higher rates of transdisciplinary experience. The motivation to improve the human condition is on the other hand correlating relatively stronger with transdisciplinary experience, although a statistically significant relation (p-value < 0.05 ) there is only a weak positive correlation  (rho ~0.33). The motivation to improve human welfare/condition is getting only slightly higher with higher transdisciplinary experience.

<!--- TODO: Display A2/A3 descriptively --->

## AGE

```{r age_bar, echo=FALSE, fig.width=8, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
c <- as.data.frame(table(data.questions$academicAge))
c <- c[2:nrow(c), ]
levels(c$Var1) <- c("", "6-10 years", "11-15 years", ">15 years" )
a_plot <- ggplot(data=c, aes(x=Var1, y=Freq)) +
  theme_light() +
  geom_bar(stat="identity", fill = col_bar) +
  xlab("Academic Age") +
  ylab("") + 
  geom_text(aes(label=Freq), vjust=1.6, color="white", size=3) 

age <- factor(data.questions$age)
levels(age) <- c(NA, "< 39", "40ies", "50ies", "60ies", "> 70")
age_table <- as.data.frame(table(age))
b_plot <- ggplot(data=age_table, aes(x=age, y=Freq)) +
  theme_light() +
  geom_bar(stat="identity", fill = col_bar2) +
  xlab("Age") +
  ylab("Count") + 
  geom_text(aes(label=Freq), vjust=1.6, color="white", size=3) 

b_plot + a_plot

```


## B1: Distribution of SI-Familiarity

```{r B1_bar, echo=FALSE, fig.width=8, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
a <- as.data.frame(table(data.questions$familiarWithSI.response.))
c <-  data.frame(t = data.questions$familiarWithSI.response.,
                 d = meta_df$domain)

c1 <- as.data.frame(table(c))
n <- sum(!is.na(data.questions$familiarWithSI.response.))
no <- length(data.questions$familiarWithSI.response.)

ggplot(data=c1, aes(x=t, y=Freq, fill = d)) +
  theme_light() +
  geom_bar(stat="identity") +
  xlab("Familiarity with SI") +
  ylab("Count") + 
  scale_fill_manual("Domain", values = col_dom) + 
  theme(legend.position="top") + 
  annotate("label", x = 10.5, y = 105, label = "bold(n) == 360/361", parse = TRUE)






```
> TODO: Description of B1


```{r}

b1_table_df <- data.frame(Answer = c("0..not at all", 1:9, "10..fully", "No answer", "Not completed", "Total(gross)"),
                          
                          Count = c(126,
                                    38,	
                                    33,	
                                    40,	
                                    25,	
                                    39,	
                                    19,	
                                    20,	
                                    21,	
                                    6,
                                    15,
                                    4,
                                    14,
                                    400
                          ),
                          
                          Percentage = c(
                            "31.50%",
                            "9.50%",
                            "8.25%",
                            "10.00%",
                            "6.25%",
                            "9.75%",
                            "4.75%",
                            "5.00%",
                            "5.25%",
                            "1.50%",
                            "3.75%",
                            "1.00%",
                            "3.50%",
                            "100.00%"
                          )
)




b1_q <- "How familiar are you with the concept of social innovation?"


myft <- flextable(b1_table_df
                  #col_keys = c("Answer",	"Count",	"Gross percentage")
)
myft <- add_header_row(
  x = myft, values = b1_q,
  colwidths = c(3))

myft <- theme_vanilla(myft)
myft <- align(myft, j=3, align = "right", part = "all")
myft <- set_table_properties(myft, layout = "autofit")
print(myft, preview = "docx")
myft
```



## Dependence of SI-familiarity on scientific domains

```{r echo=FALSE}
b1.shapiro <- shapiro.test(data$familiarWithSI.response.)
b1.barlett <- bartlett.test(data=data, familiarWithSI.response. ~ domain)
b1.kruswal <- kruskal.test(data=data, familiarWithSI.response. ~ domain)
b1.pwilcox <- pairwise.wilcox.test(data$familiarWithSI.response.,
                                   data$domain,
                                   mu = 0,
                                   alt = "two.sided",
                                   conf.int = T,
                                   conf.level = 0.95,
                                   paired = F,
                                   correct = T,
                                   p.adjust="bonferroni" )

```

```{r}
b1.shapiro
```
```{r}
b1.barlett
```
```{r}
b1.kruswal
```
```{r}
b1.pwilcox
```


Social innovation is a relatively less known concept among the survey respondents. The majority of the respondents indicated their low familiarity with SI, approximately %32 of the respondents selected the lowest level of SI-Familiarity (indicated with 0) and only 16% of the respondents selected a value equal or greater than 7 on a scale between 0 to 10. 
One of the literature-driven assumptions about SI-familiarity was that [H] *the SI-Familiarity depends on the scientific domain*. Considering the survey results are strongly skewed towards low familiarity rates, a possibly significant difference between the main scientific domains is an especially important aspect towards an understanding of SI in research.


```{r B1-boxplot, echo=FALSE, fig.width=10, fig.height=3, dev='svg', fig.retina=2, fig.align='center'}
b1domain.df <-data.frame(familiarWithSI = data$familiarWithSI.response.,
                         domain =  data$domain)

b1domain.df$familiarWithSI <- as.numeric(b1domain.df$familiarWithSI)
b1domain.df %>% 
  gather(key="domain", value="familiarWithSI") %>%
  ggplot( aes(x=familiarWithSI, y=domain, fill=domain),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ")+
  theme_light() + 
  theme(axis.text.y=element_blank())+ scale_fill_discrete(name = "Domain") + xlab("Familiarity with SI") + scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Domain") +
  scale_x_continuous(breaks = seq(0,10,2))  

```

The analysis of the survey results yields a statistically significant dependence of the SI-familiarity to the scientific domains (Kruskal-Wallis [K-W] rank sum test p-value < 0.05). However, as Figure 4 also visualises, the domains Mathematics, Natural -, & Engineering Sciences and Biology & Medicine are statistically not significantly differ from each other while Social Sciences and Humanities (SSH) show a stat. significant difference to both of the other domains. ^[Results of the pairwise comparisons using Wilcoxon rank sum test with continuity correction with Bonferonni p-value adjustment yields a p-value greater than 0.05 for Mathematics, Natural-, & Engineering Sciences. SSH, however, associated with p-values significantly smaller than 0.05 with both of the other domains]. 


## C2

```{r}
table(feat_df$contribToSI.rate.)
```

```{r C2_bar, echo=FALSE, fig.width=8, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
c <- as.data.frame(table(feat_df.num$contribToSI.rate.))
sum(!is.na(feat_df.num$contribToSI.rate.))

ggplot(data=c, aes(x=Var1, y=Freq)) +
  theme_light() +
  geom_bar(stat="identity", fill = col_bar) +
  xlab("SI-Contribution (self-assessment)") +
  ylab("Count") + 
  annotate("label", x = 1.5, y = 20.5, label = "bold(n) == 112/361", parse = TRUE)


```



# Intention & Agency

## D1: Motivation

```{r D1-likert, echo=FALSE, fig.width=12, fig.height=4 , fig.retina=2, fig.align='center', dev='svg'}
d1.df_named <- d1.df
names(d1.df_named) <- c(
  motivation.pheno. = "understand a natural, tech., econ., or social phenomenon?",
  motivation.prob. = "address a natural, tech., econ., or social problem?",
  motivation.welfare. = "improve the human condition/welfare (outside academia)?"
  
)
d1_items_likert <- 
  #round(d1.df) %>%
  d1.df_named %>%
  mutate_all(likert_recode) %>%
  likert()

mot_likert <- likert_plot(d1_items_likert, h=FALSE, c=c(1,3,5)) + ggtitle("When you designed your project, to what degree were you motivated to …")
mot_likert + theme( axis.text.y = element_text( 
  size=g_tick_size_side), axis.text.x = element_text(
    size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) + 
  annotate("label", x = 3, y = -100, label = "bold(n) == 360/361", parse = TRUE) +
  annotate("label", x = 2, y = -100, label = "bold(n) == 354/361", parse = TRUE) +
  annotate("label", x = 1, y = -100, label = "bold(n) == 355/361", parse = TRUE) 
```
```{r}


d1_table_df <- data.frame(Answer = c("0..not at all", 1:9, "10..fully", "No answer", "Not completed", "Total(gross)"),
                          
                          Count = c(14	,
                                    1	 ,	
                                    8	 ,	
                                    6	 ,	
                                    12	,	
                                    9	 ,	
                                    6	 ,	
                                    20	,	
                                    43	,	
                                    39	,
                                    214,
                                    1 ,
                                    27,
                                    400
                          ),
                          
                          Percentage = c(
                            "3.50%",
                            "0.25%",
                            "2.00%",
                            "1.50%",
                            "3.00%",
                            "2.25%",
                            "1.50%",
                            "5.00%",
                            "10.75%",
                            "9.75%",
                            "53.50%",
                            "0.25%",
                            "6.75%",
                            "100%"
                          ),
                          
                          Count2 = c(
                            24,
                            7,
                            26,
                            10,
                            16,
                            29,
                            28,
                            38,
                            58,
                            28,
                            102,
                            7,
                            27,
                            400 
                          ),
                          Percentage2 = c(
                            "6.00%",
                            "1.75%",
                            "6.50%",
                            "2.50%",
                            "4.00%",
                            "7.25%",
                            "7.00%",
                            "9.50%",
                            "14.50%",
                            "7.00%",
                            "25.50%",
                            "1.75%",
                            "6.75%",
                            "100.00%" 
                          ),
                          
                          Count3 = c(
                            47,
                            23,
                            33,
                            27,
                            18,
                            45,
                            13,
                            41,
                            54,
                            16,
                            50,
                            6,
                            27,
                            400 
                          ),
                          
                          Percentage3 = c(
                            "11.75%",
                            "5.75%",
                            "8.25%",
                            "6.75%", 
                            "4.50%",
                            "11.25%",
                            "3.25%",
                            "10.25%",
                            "13.50%",
                            "4.00%",
                            "12.50%",
                            "1.50%",
                            "6.75%",
                            "100.00%"
                          )
)



over <- "When you designed your project, to what degree were you motivated to…"
d1_q <- "better understand a natural, technical, economic, or social phenomenon?"
d2_q <- "directly address a natural, technical, economic, or social problem?"
d3_q <- "improve the human condition/welfare (outside academia)?"


myft <- flextable(d1_table_df
                  #col_keys = c("Answer",	"Count",	"Gross percentage")
)
myft <- add_header_row(
  x = myft, values = c("",d1_q, d2_q, d3_q),
  colwidths = c(1,2,2,2))
myft <- add_header_row(
  x = myft, values = c("When you designed your project, to what degree were you motivated to…"),
  colwidths = c(7))

myft <- theme_vanilla(myft)
myft <- align(myft, j=c(3,5,7), align = "right", part = "all")
myft <- set_table_properties(myft, layout = "autofit")
myft <- set_header_labels(myft, Count = "Count", 
                          Percentage = "Percentage", Count2 = "Count", 
                          Percentage2 = "Percentage", Count3 = "Count", 
                          Percentage3 = "Percentage"
)
print(myft, preview = "docx")
myft
```

```{r D1_bar, echo=FALSE, fig.width=8, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
a <- as.data.frame(table(feat_df.num$motivation.pheno.))
b <- as.data.frame(table(feat_df.num$motivation.prob.))
c <- as.data.frame(table(feat_df.num$motivation.welfare.))
sum(!is.na(feat_df.num$motivation.welfare.))

d1a <-  ggplot(data=a, aes(x=Var1, y=Freq)) +
  theme_light() +
  geom_bar(stat="identity", fill = col_bar) +
  xlab("better unders. a phenomenon") +
  ylab("Count") + 
  annotate("label", x = 3.5, y = 205, label = "bold(n) == 360/361", parse = TRUE)+ 
  ylim(0, 210)


d1b <-  ggplot(data=b, aes(x=Var1, y=Freq)) +
  theme_light() +
  geom_bar(stat="identity", fill = col_bar) +
  xlab("directly address a problem") +
  ylab("") + 
  annotate("label", x = 3.5, y = 205, label = "bold(n) == 354/361", parse = TRUE) +
  ylim(0, 210)



d1c <-  ggplot(data=c, aes(x=Var1, y=Freq)) +
  theme_light() +
  geom_bar(stat="identity", fill = col_bar) +
  xlab("improve human condition") +
  ylab("") + 
  annotate("label", x = 3.5, y = 205, label = "bold(n) == 355/361", parse = TRUE) +
  ylim(0, 210)

dd <- d1a + d1b + d1c

library("patchwork")
ggp_all <- dd  +    # Create grid of plots with title
  plot_annotation(subtitle =  "When you designed your project, to what degree were you motivated to…") & 
  theme(plot.subtitle = element_text(hjust = 0.5))
ggp_all                         
## library(ggpubr)
## ggarrange(d1a, d1b, d1c,
##                     labels = c("A", "B", "C"),
##                     ncol = 3)
```

```{r}
likert_recode_new <- function(x) {
  y <- ifelse(is.na(x), NA,
              ifelse(x <= 3, 0,
                     ifelse(x > 3 & x <7, 1,
                            ifelse(x >= 7, 2, " "))))
  
  y <- factor(y, levels = c("0...not at all - 3", "4 - 6", "7 - 10...fully"))
  
  return(y)
}
d1.welfare_rec <- likert_recode(feat_df.num$motivation.welfare.)
d1.phenome_rec <- likert_recode(feat_df.num$motivation.pheno.)
d1.problem_rec <- likert_recode(feat_df.num$motivation.prob.)
#cor(as.numeric(d1.welfare_rec), feat_df.num$impactTargetGroup.pub., use = "pairwise.complete.obs", "spearman")
cor.test(as.numeric(d1.welfare_rec), feat_df.num$impactTargetGroup.socgr., use = "pairwise.complete.obs", method = "spearman")


```

```{r D1G1-boxplot, echo=FALSE, fig.width=10, fig.height=3, dev='svg', fig.retina=2, fig.align='center'}
dg_df <- as.data.frame(cbind(d1.welfare_rec,
                             feat_df.num$impactTargetGroup.pub., 
                             feat_df.num$impactTargetGroup.civsoc.,
                             feat_df.num$impactTargetGroup.socgr.
)
)
dg_df$d1.welfare_rec <- likert_recode(feat_df.num$motivation.welfare.)

a <- dg_df[, c(1,2)] %>% 
  filter(!is.na(d1.welfare_rec)) %>%
  gather(key="V2", value="d1.welfare_rec") %>%
  ggplot(aes(x=V2, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y=element_blank(), legend.position = "none") +
  scale_fill_discrete(name = "Motivation to improve human condition") + 
  xlab("general population") + 
  scale_fill_manual(values=col_seq, name="Motivation to improve human condition") +
  scale_x_continuous(breaks = seq(0,10,2))  

b <- dg_df[, c(1,3)] %>% 
  filter(!is.na(d1.welfare_rec)) %>%
  gather(key="V3", value="d1.welfare_rec") %>%
  ggplot(aes(x=V3, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y=element_blank(), legend.position = "none") +
  scale_fill_discrete(name = "Motivation to improve human condition") + 
  xlab("specific social groups") + 
  scale_fill_manual(values=col_seq, name="Motivation to improve human condition") +
  scale_x_continuous(breaks = seq(0,10,2))  

c <- dg_df[, c(1,4)] %>% 
  filter(!is.na(d1.welfare_rec)) %>%
  gather(key="V4", value="d1.welfare_rec") %>%
  ggplot(aes(x=V4, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y=element_blank()) +
  scale_fill_discrete(name = "Motivation to improve human condition") + 
  xlab("NGOs, advocacy or civil soc. groups") + 
  scale_fill_manual(values=col_seq, name="Mot. to imp. human cond.") +
  
  scale_x_continuous(breaks = seq(0,10,2))  +
  
  guides(fill = guide_legend(reverse = TRUE))

a+b+c

## dg2_df <- as.data.frame(cbind(d1.problem_rec,
##                              feat_df.num$impactTargetGroup.pub., 
##                              feat_df.num$impactTargetGroup.civsoc.,
##                              feat_df.num$impactTargetGroup.socgr.
##                              )
##                        )
## dg3_df <- as.data.frame(cbind(d1.phenome_rec,
##                              feat_df.num$impactTargetGroup.pub., 
##                              feat_df.num$impactTargetGroup.civsoc.,
##                              feat_df.num$impactTargetGroup.socgr.
##                              )
##                        )
## 
## dg2_df$d1.problem_rec <- likert_recode(feat_df.num$motivation.prob.)
## dg3_df$d1.phenome_rec <- likert_recode(feat_df.num$motivation.pheno.)
## 
## a2 <- dg_df[, c(1,2)] %>% 
##   filter(!is.na(d1.welfare_rec)) %>%
##   gather(key="V2", value="d1.welfare_rec") %>%
##   ggplot(aes(x=V2, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
##     geom_boxplot() +
##   ylab(" ") +
##   theme_light() +
##   theme(axis.text.y=element_blank(), legend.position = "none") +
##   scale_fill_discrete(name = "Motivation to improve human condition") + 
##   xlab("general population") + 
##   scale_fill_manual(values=col_seq, name="Motivation to improve human condition")
## a3 <- dg_df[, c(1,2)] %>% 
##   filter(!is.na(d1.welfare_rec)) %>%
##   gather(key="V2", value="d1.welfare_rec") %>%
##   ggplot(aes(x=V2, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
##     geom_boxplot() +
##   ylab(" ") +
##   theme_light() +
##   theme(axis.text.y=element_blank(), legend.position = "none") +
##   scale_fill_discrete(name = "Motivation to improve human condition") + 
##   xlab("general population") + 
##   scale_fill_manual(values=col_seq, name="Motivation to improve human condition")
## 
## 
## b <- dg_df[, c(1,3)] %>% 
##   filter(!is.na(d1.welfare_rec)) %>%
##   gather(key="V3", value="d1.welfare_rec") %>%
##   ggplot(aes(x=V3, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
##     geom_boxplot() +
##   ylab(" ") +
##   theme_light() +
##   theme(axis.text.y=element_blank(), legend.position = "none") +
##   scale_fill_discrete(name = "Motivation to improve human condition") + 
##   xlab("specific social groups") + 
##   scale_fill_manual(values=col_seq, name="Motivation to improve human condition")
## 
## c <- dg_df[, c(1,4)] %>% 
##   filter(!is.na(d1.welfare_rec)) %>%
##   gather(key="V4", value="d1.welfare_rec") %>%
##   ggplot(aes(x=V4, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
##     geom_boxplot() +
##   ylab(" ") +
##   theme_light() +
##   theme(axis.text.y=element_blank()) +
##   scale_fill_discrete(name = "Motivation to improve human condition") + 
##   xlab("NGOs, advocacy or civil soc. groups") + 
##   scale_fill_manual(values=col_seq, name="Mot. to imp. human cond.") +
## 
##   guides(fill = guide_legend(reverse = TRUE))
## 
```

```{r}
colnames(dg_df) <- c("Mot.to imp. human cond.", "General popul.", "Spec. social gr.", "NGOs, civ. soc. gr.") 
rcorr(sapply(dg_df, FUN=as.numeric), type = "spearman")
```




```{r}
dg_all_df <- as.data.frame(cbind(d1.welfare_rec,
                                 d1.phenome_rec,
                                 d1.problem_rec,
                                 feat_df.num$impactTargetGroup.pub., 
                                 feat_df.num$impactTargetGroup.civsoc.,
                                 feat_df.num$impactTargetGroup.socgr.,
                                 feat_df.num$impactTargetGroup.acad.,
                                 feat_df.num$impactTargetGroup.policy.,
                                 feat_df.num$impactTargetGroup.busi.
)
)
corr.test(dg_all_df)
```


## D2: Intention &amp; Agency &ndash; Impulses from the Non-academic World

###### *Addressing a specific problem* ... 

```{r D2-bar, echo=FALSE, fig.width=8, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
data$benefitForNonAcademy[is.na(data$benefitForNonAcademy)] <- 0 
data$benefitForNonAcademy <- factor(data$benefitForNonAcademy, exclude=NA)

benef <- as.data.frame(table(data$benefitForNonAcademy))
benef$Var1 <- c( "No", "To a minor extent", "To a major extent")

sum(!is.na(feat_df.num$benefitForNonAcademy))

g <- ggplot(benef, aes(x=factor(Var1, levels = c("No", "To a minor extent", "To a major extent")) , y=Freq))
# Number of cars in each class:
benef$Var1

g + geom_col(fill=col_bar2
             ,width=0.7
) + 
  theme_light() +
  theme( axis.text.y = element_text( 
    size=g_tick_size_side), 
    axis.text.x = element_text(
      size=g_tick_size_side),
    axis.title=element_text(size=g_tick_size_side),
    legend.text=element_text(size=g_tick_size_side),
    plot.subtitle = element_text(size = 9)) + 
  geom_text(aes(label=Freq), vjust=1.6, color="white", size=5) +
  scale_x_discrete("") + 
  scale_y_continuous("count") + 
  labs(
    #title = "Effect of Vitamin C on Tooth Growth",
    subtitle = "Have you deliberately designed your project so that it might generate an immediate and intended benefit for the general 
       population or a specific non-academic target group (e.g. specific social, policy, or business actors)?")+ 
  annotate("label", x = 3.2, y = 130, label = "bold(n) == 360/361", parse = TRUE) 

```

<!-- TODO: Describe D2 -->

Our hypotheses derived from the literature research includes 2 main assumptions:

* (h_1) The rate of non-academic impulse for research differs between scientific fields.


```{r D2-boxplot, echo=FALSE, fig.width=10, fig.height=3, dev='svg', fig.retina=2, fig.align='center'}
d2domain.df <-data.frame(benefitForNonAcademy = feat_df.num$benefitForNonAcademy,
                         domain =  data$domain)

#d2domain.df$benefitForNonAcademy <- as.numeric(1domain.df$familiarWithSI)
d2domain.df %>% 
  gather(key="domain", value="benefitForNonAcademy") %>%
  ggplot( aes(x=benefitForNonAcademy, y=domain, fill=domain),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ")+
  theme_light() + 
  theme(axis.text.y=element_blank())+ scale_fill_discrete(name = "Domain") + xlab("Benefit for non-academy") + scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Domain") +
  scale_x_discrete(limits= c("0", "1", "2"), labels = c("0" = "no", "1"="to a minor extent", "2"="to a large extent"))  

```
```{r D2-barplot, echo=FALSE, fig.width=8, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
benefit <- c(rep("No" , 3), rep("To a minor extent" , 3), rep("To a major extent" , 3) )
rep(unique(d2domain.df$domain ), 3)


dom_tab <- as.data.frame(table(d2domain.df$domain, d2domain.df$benefitForNonAcademy))

dom_tab 

# Grouped
ggplot(dom_tab, aes(fill=Var1, y=Freq, x=Var2)) + 
  geom_bar(position="dodge", stat="identity") +
  xlab("Benefit for non-academy") +
  ylab("Count") + scale_x_discrete(limits= c("0", "1", "2"), labels = c("0" = "no", "1"="to a minor extent", "2"="to a large extent")) + 
  theme_light() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  + scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Domain") 
```

```{r echo=FALSE}
data$benefitForNonAcademy <- as.numeric(data$benefitForNonAcademy)
d2.shapiro <- shapiro.test(as.numeric(data$benefitForNonAcademy))
d2.barlett <- bartlett.test(data=data, benefitForNonAcademy ~ domain)
d2.kruswal <- kruskal.test(data=data, benefitForNonAcademy ~ domain)
d2.pwilcox <- pairwise.wilcox.test(data$benefitForNonAcademy,
                                   data$domain,
                                   mu = 0,
                                   alt = "two.sided",
                                   conf.int = T,
                                   conf.level = 0.95,
                                   paired = F,
                                   correct = T,
                                   p.adjust="bonferroni" )

d2domain.df <- as.data.frame(cbind(d2domain.df,
                                   citiz = feat_df.num$natureOfInvolvement.citiz.,
                                   civsoc = feat_df.num$natureOfInvolvement.civsoc.,
                                   welfare = feat_df.num$natureOfInvolvement.welfare.
))
data$natureOfInvolvement.citiz.

d2domain.df$benefitForNonAcademy <- likert_recode2(d2domain.df$benefitForNonAcademy)
# d2domain.df$citiz <- likert_recode3(d2domain.df$citiz)
# d2domain.df$civsoc <- likert_recode3(d2domain.df$civsoc)
# d2domain.df$welfare <- likert_recode3(d2domain.df$welfare)

```
```{r}
d2.kruswal
```
```{r}
d2.pwilcox
```


The deliberative approach to benefit for non-academic society shows statistically significant difference between different domains (Kruskal-Wallis Test p-value < 0.05), however while there is a stat. significant difference between SSH and Physical Sciences as well as between Bology & Medicine and Physical Sciences, there is no stat. difference between SSH and Biology & Medicine.  

* (h_2) Impulses from non-academic world correlates with the nature of involvement of societal actors in the project.

The nature of involvement of specific groups indicate how far the involvement of those were in the project (for a detailed analysis of the variable see *Nature of Involvement* under *Actors & Networks*), including the options *No*, *To a minor extent* and *To a major extent*. 

```{r D2E2-boxplot, echo=FALSE, fig.width=10, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}

a <- d2domain.df[, c(1,3)] %>% 
  filter(!is.na(benefitForNonAcademy)) %>%
  filter(!is.na(citiz)) %>%
  gather(key="citiz", value="benefitForNonAcademy") %>%
  ggplot(aes(x=citiz, y=benefitForNonAcademy, fill=benefitForNonAcademy),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme( axis.text.y=element_blank(), legend.position = "none", axis.text.x = element_text(angle = 45, , hjust = 1)) +
  scale_fill_discrete(name = "Aiming for a non-academic benefit") + 
  xlab("Nat. of Inv. (citizens)") + 
  scale_fill_manual(values=col_seq, name="Aiming for a non-academic benefit") + 
  # coord_flip() +
  scale_x_discrete(limits = c("No Involvement",
                              "Contributory",
                              "Collaboratively",
                              "Co-created"
  )) 


b <- d2domain.df[, c(1,4)] %>% 
  filter(!is.na(benefitForNonAcademy)) %>%
  filter(!is.na(civsoc)) %>%
  gather(key="civsoc", value="benefitForNonAcademy") %>%
  ggplot(aes(x=civsoc, y=benefitForNonAcademy, fill=benefitForNonAcademy),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme(axis.text.y=element_blank()) +
  # coord_flip() +
  theme_light() +
  theme(axis.text.y=element_blank(), legend.position = "none", axis.text.x = element_text(angle = 45, , hjust = 1)) +
  scale_fill_discrete(name = "Aiming for a non-academic benefit") + 
  xlab("Nat. of Inv. (civ. soc. orgs, NGOs)") + 
  scale_fill_manual(values=col_seq, name="Aiming for a non-academic benefit") +
  scale_x_discrete(limits = c("No Involvement",
                              "Contributory",
                              "Collaboratively",
                              "Co-created"
  )) 


c <- d2domain.df[, c(1,5)] %>% 
  filter(!is.na(benefitForNonAcademy)) %>%
  filter(!is.na(welfare)) %>%
  gather(key="welfare", value="benefitForNonAcademy") %>%
  ggplot(aes(x=welfare, y=benefitForNonAcademy, fill=benefitForNonAcademy)) +
  geom_boxplot() +
  ylab(" ") +
  theme(axis.text.y=element_blank()) +
  # coord_flip() +
  theme_light() +
  theme(axis.text.y=element_blank(), axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_discrete(name = "Aiming for a non-academic benefit") + 
  xlab("Nat. of Inv. (welfare -, edu. inst.)") + 
  scale_fill_manual(values=col_seq, name="Benefit for non-academy") +
  scale_x_discrete(limits = c("No Involvement",
                              "Contributory",
                              "Collaboratively",
                              "Co-created"
  )) +
  guides(fill = guide_legend(reverse = TRUE))

a+b+c
```
```{r}
cor.test(as.numeric(d2domain.df$benefitForNonAcademy), d2domain.df$civsoc, use = "pairwise.complete.obs", method = "spearman")
```

```{r}
d2.df <- d2domain.df[, c(1,3,4,5)]
d2.df <- sapply(d2.df, FUN=as.numeric)
colnames(d2.df) <- c("Benefit for non-academy",
                     "citizens",
                     "civ. soc. org.",
                     "welfare inst."
)
rcorr(d2.df, type="spearman")
```



Directly aiming to benefit society expected to correlate relatively higher with the level of participation of the societal actors. However according to the survey results the correlation between the nature of involvement of the citizens as well as civil society organisations and the deliberation to benefit society is very weak (spearman's $\rho$ ~0.15 and ~0.05 respectively). The correlation between the welfare organisations & NGOs with the same deliberative motivation is the only statistically significant one, however also this relation is a weak positive correlation (spearman's $\rho$ ~0.3).

## D3: Direct benefit for the general population or a specific non-academic group

```{r D3-bar, echo=FALSE, fig.width=8, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
d3.df_colsum <- as.data.frame(colSums(d3.df))
rownames(d3.df_colsum) <- c("societal",
                            "economic",
                            "ecological/natural",
                            "medical/health",
                            "technical")

den <- as.data.frame(d3.df)

g <- ggplot(d3.df_colsum, aes(x=rownames(d3.df_colsum), y=`colSums(d3.df)`))
# Number of cars in each class:
g + geom_col(fill=col_bar2) + 
  theme_light() + theme(axis.text.x = element_text()) + 
  scale_x_discrete("") + 
  scale_y_continuous("count") + geom_text(aes(label=`colSums(d3.df)`), vjust=1.6, color="white", size=5) + theme( axis.text.y = element_text( 
    size=g_tick_size_side), axis.text.x = element_text(
      size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) + 
  annotate("label", x = 5.2, y = 130, label = "bold(n) == ~360/361", parse = TRUE) 
```






# Actors & Networks

## E1/E2: Transdisciplinary Aspects: Inter-/Transdisciplinary Involvement

```{r E1-Involvement, echo=FALSE, fig.width=12, fig.height=6 , fig.retina=2, fig.align='center', dev='svg'}

e1.df_named <- e1.df 
names(e1.df_named) <- c(
  groupsInvolved.res. =  "researchers from other disciplines",
  groupsInvolved.busi.   = "company/business represent.",
  groupsInvolved.civsoc.=  "represent. of NGOs, advocacy or civ. soc. gr.",
  groupsInvolved.policy.=  "policy makers, public admin., represent. from gov.",
  groupsInvolved.citiz.=   "individual citizens",
  groupsInvolved.media.=   "media represent.(traditional media, digital media)",
  groupsInvolved.welfare.= "represent. from welfare- or education-providing inst."
)

e1_items_likert <- 
  #round(d1.df) %>%
  e1.df_named %>%
  mutate_all(likert_recode2) %>%
  likert()

trans_likert <- likert_plot(e1_items_likert, h=FALSE, c=c(1,3,5)) + ggtitle("In your research processes, did you actively involve one or more of the following groups?") + theme(axis.text=element_text(size=13))
trans_likert + theme( axis.text.y = element_text( 
  size=g_tick_size_side), axis.text.x = element_text(
    size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) + 
  annotate("label", x = 7, y = 100, label = "bold(n) == 361/361", parse = TRUE) +
  annotate("label", x = 6, y = 100, label = "bold(n) == 352/361", parse = TRUE) +
  annotate("label", x = 5, y = 100, label = "bold(n) == 354/361", parse = TRUE) +
  annotate("label", x = 4, y = 100, label = "bold(n) == 355/361", parse = TRUE) +
  annotate("label", x = 3, y = 100, label = "bold(n) == 353/361", parse = TRUE) +
  annotate("label", x = 2, y = 100, label = "bold(n) == 351/361", parse = TRUE) +
  annotate("label", x = 1, y = 100, label = "bold(n) == 352/361", parse = TRUE) 
```

Interdisciplinary involvement is more common among the SNF funded projects, 41% of the respondents note that the involvement of academicians from other disciplines were quite central to their specific project. Transdisciplinary involvement has been measured under different categories that indicate different type of societal actors and groups in the survey. Although not as central as the interdisciplinary involvement different types of transdisciplinary engagement constitute a noteworthy part of the research projects. 


+ similar across different groups in terms of extent and depth of involvement (*marginal* / *central*)



```{r E2-Nature, echo=FALSE, fig.width=12, fig.height=6 , fig.retina=2, fig.align='center',  dev='svg'}

e2.df_named <- e2.df 
names(e2.df_named) <- c(
  natureOfInvolvement.res. =  "researchers from other disciplines",
  natureOfInvolvement.busi.   = "company/business represent.",
  natureOfInvolvement.civsoc.=  "represent. of NGOs, advocacy or civ. soc. gr.",
  natureOfInvolvement.policy.=  "policy makers, public admin., represent. from gov.",
  natureOfInvolvement.citiz.=   "individual citizens",
  natureOfInvolvement.media.=   "media represent.(traditional media, digital media)",
  natureOfInvolvement.welfare.= "represent. from welfare- or education-providing inst."
)

e2.df_named <- e2.df_named[, 2: ncol(e2.df_named)]


e2_items_likert <- 
  #round(d1.df) %>%
  e2.df_named %>%
  mutate_all(likert_recode4) %>%
  likert()

sum(!is.na(feat_df.num$natureOfInvolvement.media.))

nature_likert <- likert_plot(e2_items_likert, h=FALSE, c = c(2:5)) + ggtitle("What was the nature of involvement of those groups?") + theme(axis.text=element_text(size=13))
nature_likert+ theme( axis.text.y = element_text( 
  size=g_tick_size_side), axis.text.x = element_text(
    size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) + 
  annotate("label", x = 6, y = 100, label = "bold(n) == 74/361", parse = TRUE) +
  annotate("label", x = 5, y = 100, label = "bold(n) == 80/361", parse = TRUE) +
  annotate("label", x = 4, y = 100, label = "bold(n) == 82/361", parse = TRUE) +
  annotate("label", x = 3, y = 100, label = "bold(n) == 51/361", parse = TRUE) +
  annotate("label", x = 2, y = 100, label = "bold(n) == 89/361", parse = TRUE) +
  annotate("label", x = 1, y = 100, label = "bold(n) == 114/361", parse = TRUE) 

```



* Transdisciplinary involvement mostly *consultative* or *contributory* in nature.
* *Collaborative* processes more likely in projects where *welfare-/education providing institutions* or *company/ business representatives* are relevant



```{r}
he_df <- as.data.frame(cbind(feat_df.num$groupsInvolved.citiz.,
                             feat_df.num$familiarWithSI.response.
)
)

cor.test( he_df$V1, he_df$V2, method = "spearman", use = "complete.obs")
```


* There is a although relatively weak (~0.35) statistically significant positive correlation between SI-Familiarity and involvement of citizens in the research project.

```{r E1B1-boxplot, echo=FALSE, fig.width=10, fig.height=3, dev='svg', fig.retina=2, fig.align='center'}
he_df$V1 <- likert_recode2(he_df$V1)
he_df %>% 
  filter(!is.na(V1)) %>%
  gather(key="V2", value="V1") %>%
  ggplot( aes(x=V2, y=V1, fill=V1),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ")+
  scale_x_continuous(breaks = seq(0,10,2)) +
  theme_light() + 
  theme(axis.text.y=element_blank()) +
  scale_fill_discrete(name = "Involvement of Citizens") +
  xlab("Familiarity with SI") +
  scale_fill_manual(values=col_seq, name="Involvement of Citizens")+
  guides(fill = guide_legend(reverse = TRUE))



```


```{r}
cor.test(feat_df.num$groupsInvolved.citiz., he_df$V2, use = "pairwise.complete.obs", method = "spearman")
```


The type of involvement of the societal actors is also important to analyse the SI-relevant characteristics of the projects. Transdisciplinary approaches are often applied to capitalize on the ability of multiplicity of non-academic actors to address a specific issue. Therefore; we expect with the higher levels of involvement of societal actors a transdisciplinary project to,  
* H_1:  explore issues previously not (widely) known in society, and secondly,


```{r E2G1-boxplot, echo=FALSE, fig.width=10, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
e2domain.df <- as.data.frame(cbind(
  unknown =feat_df.num$Impactstatements.unknown.,
  citiz = e2.df_named$`individual citizens`,
  civsoc = e2.df_named$`represent. of NGOs, advocacy or civ. soc. gr.`,
  welfare = e2.df_named$`represent. from welfare- or education-providing inst.`
))

e2domain.df$citiz <- likert_recode4(e2domain.df$citiz)
e2domain.df$civsoc <- likert_recode4(e2domain.df$civsoc)
e2domain.df$welfare <- likert_recode4(e2domain.df$welfare)

likert_recode4(feat_df.num$natureOfInvolvement.citiz.)

a <- e2domain.df[, c(1,2)] %>% 
  filter(!is.na(unknown)) %>%
  filter(!is.na(citiz)) %>%
  gather(key="unknown", value="citiz") %>%
  ggplot(aes(x=unknown, y=citiz, fill=citiz),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  scale_x_continuous(breaks = seq(0,10,2)) +
  theme_light() +
  theme( legend.position = "none", axis.text.x=element_blank()) +
  xlab("Adressed a previously unknown issue") + 
  ylab("Individual citizens") +
  scale_fill_manual(values=col_seq4
  ) + 
  coord_flip() 

b <- e2domain.df[, c(1,3)] %>% 
  filter(!is.na(unknown)) %>%
  filter(!is.na(civsoc)) %>%
  gather(key="unknown", value="civsoc") %>%
  ggplot(aes(x=unknown, y=civsoc, fill=civsoc),  show.legend = FALSE) +
  geom_boxplot() +
  xlab("Adressed a previously unknown issue") +
  scale_x_continuous(breaks = seq(0,10,2)) +
  theme_light() +
  theme( legend.position = "none", axis.text.x = element_blank()) +
  ylab("Civ. society organisations, NGOs") +
  scale_fill_manual(values=col_seq4, name="Civil soc. orgs & NGOs") + 
  coord_flip() 


c <- e2domain.df[, c(1,4)] %>% 
  filter(!is.na(unknown)) %>%
  filter(!is.na(welfare)) %>%
  gather(key="unknown", value="welfare") %>%
  ggplot(aes(x=unknown, y=welfare, fill=welfare),  show.legend = FALSE) +
  geom_boxplot() +
  xlab("Adressed a previously unknown issue") +
  scale_x_continuous(breaks = seq(0,10,2)) +
  theme_light() +
  theme(axis.text.x = element_blank()) +
  ylab("Welfare -, education organisations") +
  scale_fill_manual(values=col_seq4) + 
  coord_flip() +
  guides(fill=guide_legend(title="Nature of Involvement", reverse = TRUE)) 


a+b+c
```



```{r}
cor.test(as.numeric(feat_df.num$natureOfInvolvement.welfare.), e2domain.df$unknown, use = "pairwise.complete.obs", method = "spearman")
```
```{r}
colnames(e2domain.df) <- c("Add. an unknown issue", "citizens", "civ. soc. org.", "welfare inst.")
rcorr(sapply(e2domain.df, FUN=as.numeric), type="spearman")
```



* H_2: also aim to design/offer an up-/out-/deep-scalable solution.

The Survey question about scalability initially included 3 different categories, namely up-, out- and deep scalability. However after applying survey wide factor analysis it is decided to compile the scalability sub-variables into one single variable because of how similar information (similarity in explained variances) each of the variables deliver. 

```{r E2H2-boxplot, echo=FALSE, fig.width=10, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
e2domain.df <- as.data.frame(cbind(
  scalability = round(h2.composite, 2),
  citiz = e2.df_named$`individual citizens`,
  civsoc = e2.df_named$`represent. of NGOs, advocacy or civ. soc. gr.`,
  welfare = e2.df_named$`represent. from welfare- or education-providing inst.`
))

# d2domain.df$benefitForNonAcademy <- likert_recode2(d2domain.df$benefitForNonAcademy)
e2domain.df$citiz <- likert_recode4(e2domain.df$citiz)
e2domain.df$civsoc <- likert_recode4(e2domain.df$civsoc)
e2domain.df$welfare <- likert_recode4(e2domain.df$welfare)

a <- e2domain.df[, c(1,2)] %>% 
  filter(!is.na(scalability)) %>%
  filter(!is.na(citiz)) %>%
  gather(key="scalability", value="citiz") %>%
  ggplot(aes(x=scalability, y=citiz, fill=citiz),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.x = element_blank(), legend.position = "none") +
  scale_x_continuous(breaks = seq(0,10,2)) +
  scale_fill_discrete(name = "Individual citizens") + 
  xlab("Rate of scalability") + 
  ylab("Level of involvement (ind. citizens)") + 
  scale_fill_manual(values=col_seq4) + 
  coord_flip() +
  guides(fill=guide_legend(title="Nature of Involvement", reverse = TRUE)) 


b <- e2domain.df[, c(1,3)] %>% 
  filter(!is.na(scalability)) %>%
  filter(!is.na(civsoc)) %>%
  gather(key="scalability", value="civsoc") %>%
  ggplot(aes(x=scalability, y=civsoc, fill=civsoc),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.x = element_blank(), legend.position = "none") +
  scale_x_continuous(breaks = seq(0,10,2)) +
  # scale_fill_discrete(name = "Civil soc. orgs & NGOs") + 
  xlab("Rate of scalability") + 
  ylab("Civil soc. orgs & NGOs") + 
  scale_fill_manual(values=col_seq4, name="Nature of involvement (civil soc. orgs & NGOs)") + 
  coord_flip() +
  guides(fill=guide_legend(title="Nature of Involvement", reverse = TRUE)) 

c <- e2domain.df[, c(1,4)] %>% 
  filter(!is.na(scalability)) %>%
  filter(!is.na(welfare)) %>%
  gather(key="scalability", value="welfare") %>%
  ggplot(aes(x=scalability, y=welfare, fill=welfare),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.x = element_blank()) +
  scale_x_continuous(breaks = seq(0,10,2)) +
  xlab("Rate of scalability") + 
  ylab("Welfare -, education organisations") + 
  scale_fill_manual(values = col_seq4) + 
  coord_flip() +
  guides(fill=guide_legend(title="Nature of Involvement", reverse = TRUE)) 

a+b+c
```




```{r}
# TEST the correlations here
cor.test(as.numeric(feat_df.num$groupsInvolved.citiz.), feat_df.num$Impactstatements.emanc., use = "pairwise.complete.obs", method = "spearman")
```

```{r}
feat_df.num$Impactstatements.emanc.
```

```{r E1H2-boxplot, echo=FALSE, fig.width=10, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
e1domain.df <- as.data.frame(cbind(
  citiz = feat_df.num$groupsInvolved.citiz.,
  scalability = round(h2.composite, 2),
  understandi = feat_df.num$Impactstatements.understanding.,
  emancipatio = feat_df.num$Impactstatements.emanc.
))

e1domain.df$citiz <- likert_recode2(e1domain.df$citiz)

a <- e1domain.df[, c(1,2)] %>% 
  filter(!is.na(scalability)) %>%
  filter(!is.na(citiz)) %>%
  gather(key="scalability", value="citiz") %>%
  ggplot(aes(x=scalability, y=citiz, fill=citiz),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y = element_blank(), legend.position = "none") +
  scale_x_continuous(breaks = seq(0,10,2)) +
  scale_fill_discrete(name = "Individual citizens") + 
  xlab("Rate of scalability") + 
  ylab("Level of involvement (ind. citizens)") + 
  scale_fill_manual(values=col_seq) + 
  guides(fill=guide_legend(title="Nature of Involvement", reverse = TRUE)) 

b <- e1domain.df[, c(1,3)] %>% 
  filter(!is.na(understandi)) %>%
  filter(!is.na(citiz)) %>%
  gather(key="understandi", value="citiz") %>%
  ggplot(aes(x=understandi, y=citiz, fill=citiz),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y = element_blank(), legend.position = "none") +
  scale_x_continuous(breaks = seq(0,10,2)) +
  scale_fill_discrete(name = "Individual citizens") + 
  xlab("Generated deeper understanding") + 
  ylab(" ") + 
  scale_fill_manual(values=col_seq) + 
  guides(fill=guide_legend(title="Nature of Involvement", reverse = TRUE)) 

c <- e1domain.df[, c(1,4)] %>% 
  filter(!is.na(emancipatio)) %>%
  filter(!is.na(citiz)) %>%
  gather(key="emancipatio", value="citiz") %>%
  ggplot(aes(x=emancipatio, y=citiz, fill=citiz),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y = element_blank()) +
  scale_x_continuous(breaks = seq(0,10,2)) +
  scale_fill_discrete(name = "Individual citizens") + 
  xlab("Emancipatory impact on involved groups") + 
  ylab(" ") + 
  scale_fill_manual(values=col_seq) + 
  guides(fill=guide_legend(title="Level of Involvement", reverse = TRUE)) 

a+b+c
```

```{r}
# TEST the correlations here
cor.test(as.numeric(e1domain.df$citiz), e1domain.df$emancipatio, use = "pairwise.complete.obs", method = "spearman")

```
```{r}
e1domain2.df <- e1domain.df
colnames(e1domain2.df) <- c("Inv. of citizens", "Scalability", "Gen. understanding", "Emancip. impact")
e1domain2.df <- sapply(e1domain2.df, FUN=as.numeric)
rcorr(e1domain2.df, type = "spearman")
```


# Transdisciplinary Aspects: Target Group Goals

##### *Your project has..*

```{r E3_bar, echo=FALSE, fig.width=12, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}

library(data.table)

den_df <- as.data.frame(sapply(FUN=table, e3.df))

denden_df <- transpose(as.data.frame(sapply(FUN=table, e3.df)))
denden_df$Statement <- colnames(den_df) 

dene_df <- as.data.frame(cbind( c(denden_df$V1, denden_df$V2), c(denden_df$Statement, denden_df$Statement), c(rep("True", length(denden_df$Statement)), rep("False", length(denden_df$Statement)))))

dene_df$V1 <-  as.numeric(dene_df$V1)

ggplot(dene_df, aes(fill=V3, y=V1, x=V2)) + 
  geom_bar(position="stack", stat="identity" ) + coord_flip() + theme_light() +
  scale_x_discrete("", labels = c( 
    "targeted a group of people with specific needs",
    "included disadvantaged or marginalised people",
    "worked towards improving people’s lives.",
    "aimed at empowering people",
    "enabled diversity and exchange of different perspectives") ) +
  scale_y_continuous("Count")+
  theme(text = element_text(size=13)) +  scale_fill_manual(values = c("#D32F49", "#338BBE"), name = "") + theme( axis.text.y = element_text( 
    size=g_tick_size_side), axis.text.x = element_text(
      size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) +
  geom_text(aes(label=V1),size = 5, position = position_stack(vjust = 0.5), color="white")
#+
# annotate("label", x = 230, y = 10, label = "bold(n) == 114/361", parse = TRUE) 


```

* *Empowering people* most frequently selected (170) category among goals for target group
* *Enabling diversity and exchange of different perspectives* second most freqeuntly selected (151)
* *Worked towards improving people lives* least selected category (167)



Our literature driven assumption on the target group goals is that (H) higher levels of SI-Familiarity correlates with the focus on marginalised social groups as well as social groups in need.

```{r E3B1-boxplot, echo=FALSE, fig.width=12, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
e3domain.df <- as.data.frame(cbind(
  sifam = feat_df.num$familiarWithSI.response.,
  socneeds = feat_df.num$targetGroupsGoals.socneeds.,
  socmargi = feat_df.num$targetGroupsGoals.socgroups.
))


# d2domain.df$benefitForNonAcademy <- likert_recode2(d2domain.df$benefitForNonAcademy)
e3domain.df$socneeds <- factor(e3domain.df$socneeds, labels = c("False", "True"))
e3domain.df$socmargi <- factor(e3domain.df$socmargi, labels = c("False", "True"))

a <- e3domain.df[, c(1,2)] %>% 
  filter(!is.na(sifam)) %>%
  filter(!is.na(socneeds)) %>%
  gather(key="sifam", value="socneeds") %>%
  ggplot(aes(x=sifam, y=socneeds, fill=socneeds),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme( legend.position = "none") +
  # scale_fill_discrete(name = "Nature of involvement (socneeds)") + 
  xlab("SI-Familiarity") + 
  # ylab("Level of involvement (ind. citizens)") + 
  # scale_fill_manual(values=c("#FC4E07", "#00AFBB"), name="Nature of involvement (citizens)") + 
  coord_flip() 


b <- e3domain.df[, c(1,3)] %>% 
  filter(!is.na(sifam)) %>%
  filter(!is.na(socmargi)) %>%
  gather(key="sifam", value="socmargi") %>%
  ggplot(aes(x=sifam, y=socmargi, fill=socmargi),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme( legend.position = "none") +
  scale_fill_discrete(name = "Nature of involvement (civil soc. orgs & NGOs)") + 
  xlab("SI-Familiarity") + 
  # ylab("Level of involvement (civ. society organisations, NGOs)") + 
  # scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB", "#00AFBB"), name="Nature of involvement (citizens)") + 
  coord_flip() 

a+b
```

```{r}
# Do non-param relation tests instead
cor.test(as.numeric(e3domain.df$socmargi), e2domain.df$scalability, use = "pairwise.complete.obs", method = "spearman")
```








# [TBE]



## F1: Regulatory Framework: Open Science Concepts

###### Norms, requirements, practices applicable to research projects


```{r F1_bar, fig.width=12, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
library(data.table)

f1_df <- as.data.frame(sapply(FUN=table, f1.df))

f1den_df <- transpose(as.data.frame(sapply(FUN=table, f1.df)))
f1den_df$concepts <- colnames(f1_df) 

f1dene_df <- as.data.frame(cbind( c(f1den_df$V2,f1den_df$V1), c(f1den_df$concepts, f1den_df$concepts), c(rep("Yes", length(f1den_df$concepts)), rep("No", length(f1den_df$concepts)))))

f1dene_df$V1 <- as.numeric(f1dene_df$V1)
ggplot(f1dene_df, aes(fill=V3, y=V1, x=V2)) + 
  geom_bar(position="stack", stat="identity") + coord_flip() + theme_light()  +
  scale_x_discrete("", labels = c( 
    concepts.pub. =  "open access (publications)", 
    concepts.data. = "open access (research data)",
    concepts.code. = "open source (code)",
    concepts.infra.="open/shared infrastructure",
    concepts.review.= "open peer review "
  ) ) +
  scale_y_continuous("count")+
  theme(text = element_text(size=13)) +  scale_fill_manual(values = c("#D32F49", "#338BBE"), name = "") + theme( axis.text.y = element_text( 
    size=g_tick_size_side), axis.text.x = element_text(
      size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) +
  geom_text(aes(label=V1),size = 5, position = position_stack(vjust = 0.5), color="white") +
  labs(
    #title = "Effect of Vitamin C on Tooth Growth",
    subtitle = "Did one or more of the following concepts (norms, requirements, practices) apply to your research project?")



```
* *Open access to publications* most frequently selected category (326 times),
* followed by *open access to data* (234 times)


```{r}
os <- feat_df.num$concepts.code. + 
  feat_df.num$concepts.data. +
  feat_df.num$concepts.infra. +
  feat_df.num$concepts.pub. +
  feat_df.num$concepts.review.


```


```{r F1A1, echo=FALSE, fig.width=10, fig.height=3, dev='svg', fig.retina=2, fig.align='center'}

f1a1 <- as.data.frame(cbind(
  feat_df.num$transdisciplinaryExp.rate.,
  os
))
# TODO: Interpret the correlations
cor(feat_df.num$transdisciplinaryExp.rate., os, method = "spearman", use = "pairwise.complete.obs")

f1a1$V1 <- likert_recode(f1a1$V1)

f1a1_boxplot <- f1a1 %>% 
  filter(!is.na(V1)) %>%
  gather(key="V1", value="os") %>%
  ggplot(aes(x=os, y=V1, fill=V1),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  xlab("Number of different open science practices") + 
  # scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), 
  # scale_fill_manual(values=col_seq[(length(col_seq) -2):length(col_seq) ], 
  scale_fill_manual(values=col_seq, 
                    name="Transdisciplinary Experience") +
  
  theme(axis.text.y=element_blank()) 

# scale_x_continuous(breaks = seq(0,10,2))  


f1a1_boxplot 

```


## F2: Regulatory Framework: Gender Dimension & Support for Policy-Making



###### Explicit consideration of gender in research

```{r gender_bar, echo=FALSE, fig.width=10, fig.height=3, dev='svg', fig.retina=2, fig.align='center'}
f2.df <- as.data.frame(table(data$concepts2))
f2.df <- f2.df[2:3,]

sum(!is.na(feat_df.num$concepts3))
g <- ggplot(f2.df, aes(x=Var1, y=Freq))
# Number of cars in each class:
g + geom_col(fill="#D32F49")+
  scale_x_discrete("", labels = c("No", "Yes")) +
  scale_y_continuous("count") + 
  theme_minimal()+ geom_text(aes(label=Freq), vjust=1.6, color="white", size=5) + theme( axis.text.y = element_text( 
    size=g_tick_size_side), axis.text.x = element_text(
      size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) +
  annotate("label", x = 2.2, y = 250, label = "bold(n) == 357/361", parse = TRUE) 

```
* Vast majority of participants (275) stated *gender* was no explicit consideration in their project


## F3: Regulatory Framework: Gender Dimension & Support for Policy-Making

###### Aim: support of evidence-based policy-making
```{r evi_bar, echo=FALSE, fig.width=10, fig.height=3, dev='svg', fig.retina=2, fig.align='center'}
f3.df <- as.data.frame(table(data$concepts3))
f3.df <- f3.df[2:3,]
g <- ggplot(f3.df, aes(x=Var1, y=Freq))
# Number of cars in each class:
g + geom_col(fill= "#338BBE") +
  scale_x_discrete("", labels = c("No", "Yes")) +
  scale_y_continuous("count") + 
  theme_minimal()+ geom_text(aes(label=Freq), vjust=1.6, color="white", size=5) + theme( axis.text.y = element_text( 
    size=g_tick_size_side), axis.text.x = element_text(
      size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) +
  annotate("label", x = 2.2, y = 250, label = "bold(n) == 356/361", parse = TRUE)
```
* ~ a third of projects aimed at supporting evidence-based policy-making

* H: The underlying assumption is that projects with a social innovation inclination may want to have an impact on policymaking as social innovation is associated with willingness to create change. Since there are other ways to create change than through policy-making, answering no to this question does not mean that the project is not socially innovative. However, a yes answer gives an indication of whether the project is leaning towards social innovation. 


<!-- TODO: This sounds garbage-->
We assume that there is a relationship between the aim to evidence-based policy making and the benefitial outcomes of the research 


# Outcome Orientation

## G1: Direct Contribution

.right[.small[N = 360]]

```{r G1_bar, echo=FALSE, fig.width=12, fig.height=6 , fig.retina=2, fig.align='center',  dev='svg'}
g1.df_named <- g1.df
names(g1.df_named) <- 
  c(
    impactTargetGroup.pub. = "the general population",
    impactTargetGroup.busi.= "businesses",
    impactTargetGroup.socgr. = "specific social groups",
    impactTargetGroup.welfare. = "welfare- and educational inst.",
    impactTargetGroup.civsoc. = "NGOs, advocacy or civil soc. groups",
    impactTargetGroup.policy. = "policy-making, public admin., gov. org.",
    impactTargetGroup.acad. = "academia"
  )
g1.df_named <- g1.df_named[, 1:(ncol(g1.df_named)-1)]

sum(!is.na(g1.df_named$`NGOs, advocacy or civil soc. groups`))

g1_items_likert <- 
  #round(d1.df) %>%
  g1.df_named %>%
  mutate_all(likert_recode) %>%
  likert()


outcome_likert <- likert_plot(g1_items_likert, h=FALSE, c=c(1,3,5)) + ggtitle("To what degree has your project contributed to new/better services, products, processes towards...") 

outcome_likert+ theme(axis.text=element_text(size=13)) + theme( axis.text.y = element_text( 
  size=g_tick_size_side), axis.text.x = element_text(
    size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) + 
  annotate("label", x = 6, y = 100, label = "bold(n) == 355/361", parse = TRUE) +
  annotate("label", x = 5, y = 100, label = "bold(n) == 354/361", parse = TRUE) +
  annotate("label", x = 4, y = 100, label = "bold(n) == 354/361", parse = TRUE) +
  annotate("label", x = 3, y = 100, label = "bold(n) == 352/361", parse = TRUE) +
  annotate("label", x = 2, y = 100, label = "bold(n) == 353/361", parse = TRUE) +
  annotate("label", x = 1, y = 100, label = "bold(n) == 347/361", parse = TRUE) 
```



* A tiny minority directly contributed to *new or better services, products, or processes* for civil society organisations
* However, 18 % of respondents stated to have strongly contributed to benefit the general population




H: We assume social innovation to be outcome-oriented. This means that social innovation projects usually end with a tangible or non-tangible output. This could, for example, be a new product, a service or a process.

**We assume that the inclusion of each societal group plays a psoitive role in the outcomes of that specific group**

```{r, echo=FALSE, fig.width=12, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
# A correlation matrix of G1 and E1
g1.df
e1.df
corm <- corr.test(e1.df,g1.df, use = "pairwise.complete.obs", method = "spearman")
corm$r
corr.p(corm$r, corm$n)

```

```{r}

library(ggheatmap)
e11.df <- e1.df[, 2:ncol(e1.df) ]
g11.df <- g1.df[, 1:ncol(g1.df)-1]

e11.df <- e11.df[, c(4, 1, 2, 6, 3 )]
g11.df <- g11.df[, c(1:2,5,4, 6 )]

eg_df <- as.data.frame(cbind(e11.df, g11.df))

a <- eg_df[, c(1,6)] %>% 
  filter(!is.na(groupsInvolved.citiz.)) %>%
  filter(!is.na(impactTargetGroup.pub.)) %>%
  gather(key="groupsInvolved.citiz.", value="impactTargetGroup.pub.") %>%
  ggplot(aes(x=groupsInvolved.citiz., y=impactTargetGroup.pub., fill=impactTargetGroup.pub.),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y = element_blank(), legend.position = "none") +
  scale_x_continuous(breaks = seq(0,10,2)) +
  scale_fill_discrete(name = "Individual citizens") + 
  xlab("Rate of scalability") + 
  ylab("Level of involvement (ind. citizens)") + 
  scale_fill_manual(values=col_seq) + 
  guides(fill=guide_legend(title="Nature of Involvement", reverse = TRUE)) 


```


## G2: Intended Effects

###### Intended short- or long-term change benefiting specific target groups or the general population:

```{r G2_bar, echo=FALSE, fig.width=12, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}

den_df <- as.data.frame(sapply(FUN=table, g2.df[, 1:ncol(g2.df)-1]))
rownames(den_df)[1] <- "NA"
den_df <- den_df[c(2:4,6), ]

den2_df <- transpose(den_df)
den2_df$change <- colnames(den_df)

den3_df <- as.data.frame(cbind(
  Count = c(den2_df$V1, den2_df$V2, den2_df$V3, den2_df$V4), 
  target_group = rep(den2_df$change, 4),
  change = rep(rownames(den_df),  each=7)
))

den3_df$Count <- as.numeric(den3_df$Count)
den3_df <- den3_df[!den3_df$target_group == "kindOfChange.acad.",]
rownames(den3_df) <- 1:nrow(den3_df)
den3_df <- den3_df[c(19:24, 7:12, 1:6, 13:18) ,]
den3_df$change <- factor(den3_df$change, levels = c("beh", "att", "awar", "und" ))

sum(!is.na(feat_df.num$kindOfChange.welfare.))

ggplot(den3_df,
       aes(fill = change,
           y = Count,
           x = target_group)
) + 
  geom_bar(position = "stack",
           stat = "identity"
  ) + 
  coord_flip() + 
  theme_minimal() +
  scale_x_discrete("", labels = c( 
    kindOfChange.pub.			= "the general population",
    kindOfChange.busi.		=	"businesses",
    kindOfChange.socgr.		= "specific social groups",
    kindOfChange.welfare.	=	"welfare, education inst.",	
    kindOfChange.civsoc.	=	"NGOs, civil soc. groups",	
    kindOfChange.policy.	=	"policy-making, public admin."
    # kindOfChange.acad.	  = "academia" # Academia or no academia?
  )) +
  theme(axis.text.y = element_text(size = g_tick_size_main),
        axis.text.x = element_text(size = g_tick_size_side),
        legend.text = element_text(size = g_tick_size_side)
  )  +
  scale_fill_manual(labels = c("behaviour",
                               "attitude",
                               "awareness",
                               "understanding"
  ), 
  # values = c("#43bea5",
  #            "#E7B800",
  #            "#00AFBB",
  #            "#FC4E07" )
  values = c("#f4a582",
             "#92c5de",
             "#4393c3",
             "#2166ac")[4:1]
  ) +  
  geom_text(aes(label = Count),
            size = 5, 
            position = position_stack(vjust = 0.5),
            color = "white"
  ) + 
  labs(
    #title = "Effect of Vitamin C on Tooth Growth",
    subtitle = "Intended short- or long-term change benefiting specific target groups or the general population:") +  
  annotate("label", x = 1, y = 170, label = "bold(n) == 88/361", parse = TRUE) +
  annotate("label", x = 2, y = 170, label = "bold(n) == 50/361", parse = TRUE) +
  annotate("label", x = 3, y = 170, label = "bold(n) == 112/361", parse = TRUE) +
  annotate("label", x = 4, y = 170, label = "bold(n) == 154/361", parse = TRUE) +
  annotate("label", x = 5, y = 170, label = "bold(n) == 68/361", parse = TRUE) +
  annotate("label", x = 6, y = 170, label = "bold(n) == 86/361", parse = TRUE) +
  
  theme(legend.position="bottom")


```

* Improving the *understanding* in the general population as well as raising the *awareness* by far the most frequently selected category (79 and 50 times)
* *Changing behaviour* most frequently stated for policy-makers/public administrators





```{r G2E2, echo=FALSE, dev='svg', fig.retina=2, fig.align='center'}
library(ggcorrplot)
corr.test(feat_df.num$natureOfInvolvement.citiz., feat_df.num$kindOfChange.pub.)

nat_change <- as.data.frame(cbind(
  "Citizens (NoI)" = feat_df.num$natureOfInvolvement.citiz.,
  "Civil Soc. (NoI)" = feat_df.num$natureOfInvolvement.civsoc.,
  "Welfare Org. (NoI)" = feat_df.num$natureOfInvolvement.welfare., 
  "Policy Mak. (NoI)" = feat_df.num$natureOfInvolvement.policy., 
  "Citizens (KoC)" = feat_df.num$kindOfChange.pub.,
  "Civil Soc. (KoC)" =feat_df.num$kindOfChange.civsoc.,
  "Welfare Org. (KoC)" =feat_df.num$kindOfChange.welfare.,
  "Policy Mak. (KoC)" =feat_df.num$kindOfChange.policy.
)
)
corr <- round(cor(nat_change, use = "pairwise.complete.obs"), 2)


ggcorrplot(corr, type = "lower", lab = TRUE,
           outline.col = "white",
           ggtheme = ggplot2::theme_light,
           colors = c(col_seq[3], "white", col_seq[1])) +
  labs(caption = "KoC: Kind of Change\nNoI: Nature of Involvement")
```

```{r}
rcorr(sapply(nat_change, FUN=as.numeric), type = "spearman")
```



```{r}

nat_change$`Citizens (NoI)`
a <- nat_change[, c(1,5)] %>% 
  filter(!is.na(`Citizens (KoC)`)) %>%
  filter(!is.na(`Citizens (NoI)`)) %>%
  gather(key=`Citizens (KoC)`, value=`Citizens (NoI)`) %>%
  ggplot(aes(x=`Citizens (KoC)`, y=`Citizens (NoI)`, fill=`Citizens (NoI)`),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y = element_blank(), legend.position = "none") +
  scale_x_continuous(breaks = seq(0,10,2)) +
  scale_fill_discrete(name = "Individual citizens") + 
  xlab("Rate of scalability") + 
  ylab("Level of involvement (ind. citizens)") + 
  scale_fill_manual(values=col_seq) + 
  guides(fill=guide_legend(title="Nature of Involvement", reverse = TRUE)) 

b <- e1domain.df[, c(1,3)] %>% 
  filter(!is.na(understandi)) %>%
  filter(!is.na(citiz)) %>%
  gather(key="understandi", value="citiz") %>%
  ggplot(aes(x=understandi, y=citiz, fill=citiz),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y = element_blank(), legend.position = "none") +
  scale_x_continuous(breaks = seq(0,10,2)) +
  scale_fill_discrete(name = "Individual citizens") + 
  xlab("Generated deeper understanding") + 
  ylab(" ") + 
  scale_fill_manual(values=col_seq) + 
  guides(fill=guide_legend(title="Nature of Involvement", reverse = TRUE)) 

c <- e1domain.df[, c(1,4)] %>% 
  filter(!is.na(emancipatio)) %>%
  filter(!is.na(citiz)) %>%
  gather(key="emancipatio", value="citiz") %>%
  ggplot(aes(x=emancipatio, y=citiz, fill=citiz),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y = element_blank()) +
  scale_x_continuous(breaks = seq(0,10,2)) +
  scale_fill_discrete(name = "Individual citizens") + 
  xlab("Emancipatory impact on involved groups") + 
  ylab(" ") + 
  scale_fill_manual(values=col_seq) + 
  guides(fill=guide_legend(title="Level of Involvement", reverse = TRUE)) 

a+b+c

```



## G4 & G5: Uptake by Decision-Makers

###### *To what extent were project results taken up by policy-making and/or public administration and/or governmental agencies?*

```{r G4_bar, echo=FALSE, fig.height=4}
g4.df <- as.data.frame(g4.df
)

g4_freq.df <-  g4.df %>%
  mutate_all(likert_recode) %>%
  table() %>%
  as.data.frame()

sum(!is.na(g4.df))

g <- ggplot(g4_freq.df, aes(x=., y=Freq))
# Number of cars in each class:
g + geom_col(fill="#338BBE")+
  #scale_x_discrete("", labels = c("No", "Yes")) +
  scale_y_continuous("count") + 
  theme_minimal()+ geom_text(aes(label=Freq), vjust=1.6, color="white", size=5) + theme( axis.text.y = element_text( 
    size=g_tick_size_side), axis.text.x = element_text(
      size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) +
  labs(subtitle = "To what extent were project results taken up 
       by policy-making and/or public administration and/or governmental agencies?") +
  annotate("label", x = 3.2, y = 200, label = "bold(n) == 296/361", parse = TRUE) 


```

*  ~ 20 % rated the *uptake of the project results by decision-makers* moderate to high


###### In what way were those results taken up by policy-making and/or public administration and/or governmental agencies?



```{r G5_bar, echo=FALSE, fig.height=4}

g5_freq.df <- g5.df[, 1:ncol(g5.df)-1]
g5_freq.df <- as.data.frame(sapply(FUN=table, g5_freq.df))
g5_freq.df <- g5_freq.df[2,]
g5_freq.df2 <- as.data.frame(transpose(g5_freq.df))
g5_freq.df2$changed <- colnames(g5_freq.df)

sum(!is.na(data$adoptByPolicyHow.SQ001.))

g <- ggplot(g5_freq.df2, aes(x=changed, y=V1))
# Number of cars in each class:
g + geom_col(fill="#D32F49")+
  #scale_x_discrete("", labels = c("No", "Yes")) +
  scale_y_continuous("count") + 
  scale_x_discrete("", labels = c("Changed policy (measures)", 
                                  "Changed agenda-setting", 
                                  "Changed regulation or law")) + 
  theme_minimal()+ geom_text(aes(label=V1), vjust=1.6, color="white", size=5) + theme( axis.text.y = element_text( 
    size=g_tick_size_side), axis.text.x = element_text(
      size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) +
  labs(subtitle = "In what way were those results taken up by 
       policy-making and/or public administration and/or governmental agencies?") +
  annotate("label", x = 3.2, y = 29, label = "bold(n) == 361/361", parse = TRUE) 

```

* 9 projects claimed to have influenced *specific laws or regulations*
* 53 projects stated to have changed a *policy or agenda*


```{r G5E2, echo=FALSE, fig.width=10, fig.height=3, dev='svg', fig.retina=2, fig.align='center'}

g5e2 <- as.data.frame(cbind(
  feat_df.num$natureOfInvolvement.policy.,
  feat_df.num$adoptByPolicyHow.SQ001.
))
# TODO: Interpret the correlations
cor(feat_df.num$transdisciplinaryExp.rate., os, method = "spearman", use = "pairwise.complete.obs")

f1a1$V1 <- likert_recode(f1a1$V1)

f1a1_boxplot <- f1a1 %>% 
  filter(!is.na(V1)) %>%
  gather(key="V1", value="os") %>%
  ggplot(aes(x=os, y=V1, fill=V1),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  xlab("Number of different open science practices") + 
  # scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), 
  # scale_fill_manual(values=col_seq[(length(col_seq) -2):length(col_seq) ], 
  scale_fill_manual(values=col_seq, 
                    name="Transdisciplinary Experience") +
  
  theme(axis.text.y=element_blank()) 

# scale_x_continuous(breaks = seq(0,10,2))  


f1a1_boxplot 

```

## G6: Impact Statements


```{r G6_bar, echo=FALSE, fig.width=12, fig.height=6 , fig.retina=2, fig.align='center',  dev='svg'}
g6.df_named <- g6.df
names(g6.df_named) <- 
  c(
    Impactstatements.capab. = "The targ. groups have gained capab. to tackle similar issues",
    Impactstatements.emanc. = "The project played an emancipatory role",
    Impactstatements.understanding. = "The pro. gen. a better underst. of a  social issue",
    Impactstatements.mitig. = "The pro. contrib. to the mitigation of a social issue",        
    Impactstatements.unknown. = "The pro. res. addressed an issue that was not known before.",       
    Impactstatements.unaddressed. = "The scrutin. issue was not addressed in academia before"  
  )

sum(!is.na(g6.df_named$`The scrutin. issue was not addressed in academia before`))

g6_items_likert <- 
  #round(d1.df) %>%
  g6.df_named %>%
  mutate_all(likert_recode) %>%
  likert()

outcome_likert <- likert_plot(g6_items_likert, h=FALSE, c = c(1,3,5)) + ggtitle("To what extent do the following statements apply to your project?") 

outcome_likert + theme( axis.text.y = element_text( 
  size=g_tick_size_side), axis.text.x = element_text(
    size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) +
  annotate("label", x = 1, y = 100, label = "bold(n) == 272/361", parse = TRUE) +
  annotate("label", x = 2, y = 100, label = "bold(n) == 273/361", parse = TRUE) +
  annotate("label", x = 3, y = 100, label = "bold(n) == 290/361", parse = TRUE) + 
  annotate("label", x = 4, y = 100, label = "bold(n) == 286/361", parse = TRUE) +
  annotate("label", x = 5, y = 100, label = "bold(n) == 302/361", parse = TRUE) +
  annotate("label", x = 6, y = 100, label = "bold(n) == 328/361", parse = TRUE) 


```


* Academic dimension most frequently chosen,
* followed by *issues not widely known in society* and *generate a deeper understanding of a specific social issues*.

```{r G6D1-boxplot, echo=FALSE, fig.width=10, fig.height=3, dev='svg', fig.retina=2, fig.align='center'}
gd_df <- as.data.frame(cbind(d1.welfare_rec,
                             feat_df.num$Impactstatements.understanding.,
                             feat_df.num$Impactstatements.capab.,
                             feat_df.num$Impactstatements.emanc.
)
)
gd_df$d1.welfare_rec <- likert_recode(feat_df.num$motivation.welfare.)

a <- dg_df[, c(1,2)] %>% 
  filter(!is.na(d1.welfare_rec)) %>%
  gather(key="V2", value="d1.welfare_rec") %>%
  ggplot(aes(x=V2, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y=element_blank(), legend.position = "none") +
  scale_fill_discrete(name = "The project generated a better understanding of a social issue") + 
  xlab("Created a better understanding...") + 
  scale_fill_manual(values=col_seq, name="Motivation to improve human condition") +
  scale_x_continuous(breaks = seq(0,10,2))

b <- gd_df[, c(1,3)] %>% 
  filter(!is.na(d1.welfare_rec)) %>%
  gather(key="V3", value="d1.welfare_rec") %>%
  ggplot(aes(x=V3, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y=element_blank(), legend.position = "none") +
  scale_fill_discrete(name = "Motivation to improve human condition") + 
  xlab("Generated capabilities for the inv. group") + 
  scale_fill_manual(values=col_seq, name="Motivation to improve human condition") +
  scale_x_continuous(breaks = seq(0,10,2))

c <- gd_df[, c(1,4)] %>% 
  filter(!is.na(d1.welfare_rec)) %>%
  gather(key="V4", value="d1.welfare_rec") %>%
  ggplot(aes(x=V4, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
  geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y=element_blank()) +
  scale_fill_discrete(name = "Motivation to improve human condition") + 
  xlab("Played an emancipatory role") + 
  scale_fill_manual(values=col_seq, name="Mot. to imp. human cond.") +
  scale_x_continuous(breaks = seq(0,10,2)) +
  guides(fill = guide_legend(reverse = TRUE))

# a+b+c

```

```{r}
corr.test(sapply(gd_df, FUN=as.numeric), use = "pairwise.complete.obs", method = "spearman")
```

```{r}
colnames(gd_df) <- c("Mot. to imp. human cond.", "gen. understanding", "gen. capabilities", "played emancipatory role")
rcorr(sapply(gd_df, FUN=as.numeric), type="spearman")
```


# Dissemination and Exploitation

# H1: Dissemination Channels

```{r H1_bar, echo=FALSE, fig.width=10, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}


h11.df <- h1.df[,1:(ncol(h1.df)-1)]
h12.df <- h11.df[,c(1:2, 4:9, 11)]
h1den_df <- transpose(as.data.frame(sapply(FUN=table, h12.df)))
h1den_df$diss <- colnames(h12.df) 

h1den_df <- h1den_df[, 2:3]
h1den_df$V2 <- as.numeric(h1den_df$V2)

g <- ggplot(h1den_df, aes(x=reorder(diss, V2), y=V2))
# Number of cars in each class:
g + geom_col(fill="#D32F49")+
  #scale_x_discrete("", labels = c("No", "Yes")) +
  scale_y_continuous("count") + 
  scale_x_discrete("", labels = c(
    dissChannels.peer.	= "Peer reviewed journal publication",
    dissChannels.mono.	= "Monography, contribution to a book",
    dissChannels.conf.	= "Conference proceeding",
    dissChannels.policy. = "Policy brief(s)",	
    dissChannels.trad.	= "Traditional media (TV/radio/print/etc.)",	
    dissChannels.prof.	= "Professional journals/magazines targeting practitioners",
    dissChannels.web.		=	"Own institutional or project website/blog",
    dissChannels.socmed. = "Social media",
    dissChannels.events. = "Targeted events for (non-academic) practitioners",
    dissChannels.platf. = "Online platforms (other than social media channels)"
  )) + 
  theme_minimal()+ geom_text(aes(label=V2), hjust=1.6, color="white", size=5) + theme( axis.text.y = element_text( 
    size=g_tick_size_side), axis.text.x = element_text(
      size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) + coord_flip()

```
* Unsurprisingly, the vast majority published in peer-reviewed journals
* Policy briefs were rated lowest but 110 projects stated to have organised events for non-academic practitioners 





# H2: Dissemination and Exploitation: Scalability


```{r H2_bar, echo=FALSE, fig.width=10, fig.height=4, fig.retina=2, dev = "svg", fig.align='center'}
h2.df_named <- h2.df
names(h2.df_named) <- c(
  scalabilityRating.up. = "Scaling-up",
  scalabilityRating.out. ="Scaling-out",
  scalabilityRating.deep. =  "Scaling-deep"
)

h2_items_likert <- 
  #round(d1.df) %>%
  h2.df_named %>%
  mutate_all(likert_recode) %>%
  likert()

outcome_likert <- likert_plot(h2_items_likert, h=FALSE, c = c(1,3,5)) + ggtitle("How would you assess in the long term the scalability of the results generated by your project?") 

outcome_likert + theme( axis.text.y = element_text( 
  size=g_tick_size_side), axis.text.x = element_text(
    size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) +
  annotate("label", x = 1, y = 100, label = "bold(n) == 140/361", parse = TRUE) +
  annotate("label", x = 2, y = 100, label = "bold(n) == 149/361", parse = TRUE) +
  annotate("label", x = 3, y = 100, label = "bold(n) == 172/361", parse = TRUE) 

```

* 69 % of the respondents were confident of the scaling-up potential of the project results






---

# Notes

* Considering most of the variables are not normally distributed non parametric tests are returning statistically more robust outcomes. 