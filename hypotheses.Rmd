---
title: "19_hypotheses"
output:
  html_document:
    df_print: paged
    self_contained: false
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
rm(list=ls()) 
library(likert)
library(dplyr)
library(plyr)
library(tidyverse)
library(patchwork)

source("./02_analysis/02_static_responses.R")
# colnames of the specific question groups
source("./02_analysis/99_question_groups.R")

knitr::opts_chunk$set(fig.retina=2,
                      echo=FALSE,
                      dev='svg'
                      )

# Settings
g_tick_size_main <- 14
g_tick_size_side <- 12


#----------- Variable Names
# B1: SI-Familiarity
# WT: Wilcoxon

# ----------- TODO
# TODO: Find consistent colorschemes

corr_boxplot <- function(df, V1, V2 ) {
  out_plot <- df %>% 
    filter(!is.na(V1)) %>%
    gather(key=V2, value=V1) %>%
    ggplot( aes(x=V2, y=V1, fill=V1),  show.legend = FALSE) +
    geom_boxplot() +
    ylab(" ")+
    theme_light() + 
    theme(axis.text.y=element_blank())
  
  return(out_plot)
}
```

# Familiarity with SI and Transdisciplinarity

```{r echo=FALSE, fig.align='center', fig.height=4, fig.retina=2, fig.width=12, message=FALSE, warning=FALSE, dev='svg', include=TRUE}

a1b1c2 <- as.data.frame(cbind(
  data[, a1.colnames],
  data$familiarWithSI.response.,
  data$contribToSI.rate.
))

names(a1b1c2) <- c(
  V1 = "Experience with transdisciplinary research",
  V2 = "Familiarity with the concept of 'social innovation'",
  V3 = "Project's contribution to social innovation"
)

#likert_recode(a1b1c2)
items_likert <- 
  #round(d1.df) %>%
  a1b1c2 %>%
  mutate_all(likert_recode) %>%
  #likert(grouping=data$domain)
  likert()

likert_plot(items_likert, h=FALSE, c=c(1,3,5)) + theme( axis.text.y = element_text( 
                         size=g_tick_size_main), axis.text.x = element_text(
                         size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) 
  #scale_fill_discrete(name = "")
#c("#CA0020", "#F4A582", "#DFDFDF", "#92C5DE", "#92C5DE")

```

## A1: Experience with transdisciplinary Research

46% of the respondents note their high level of transdisciplinary experience. 

We assume transdisciplinary experience often correlates with getting motivated by goals that are not purely academic. This definition includes motivation to *directly address a natural, technical, economic, or social problem?* and to *improve the human condition/welfare*.

```{r A1-boxplot, echo=FALSE, fig.width=24, fig.height=8, dev='svg', fig.retina=2, fig.align='center'}
ad_df <- as.data.frame(cbind(
  a1 = feat_df.num$transdisciplinaryExp.rate.,
  d12 = feat_df.num$motivation.prob.,
  d13 = feat_df.num$motivation.welfare.
))

ad_df$a1 <- likert_recode(ad_df$a1)

# TODO: Interpret the correlations
cor(feat_df.num$transdisciplinaryExp.rate., ad_df$d13, method = "spearman", use = "pairwise.complete.obs")
cor(feat_df.num$transdisciplinaryExp.rate., ad_df$d12, method = "spearman", use = "pairwise.complete.obs")

a11_boxplot <- ad_df[, c(1,2)] %>% 
  filter(!is.na(a1)) %>%
  gather(key="d12", value="a1") %>%
  ggplot(aes(x=d12, y=a1, fill=a1),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y=element_blank()) +
  xlab("Motivation to better understand a phenomenon") + 
  scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Transdisciplinary Experience")


a12_boxplot <- ad_df[, c(1,3)] %>% 
  filter(!is.na(a1)) %>%
  gather(key="d13", value="a1") %>%
  ggplot(aes(x=d13, y=a1, fill=a1),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y=element_blank()) +
  xlab("Motivation to improve human condition") + 
  scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Transdisciplinary Experience")

a11_boxplot + a12_boxplot

```


<!--- TODO: Display A2/A3 descriptively --->


## B1: Distribution of SI-Familiarity

```{r}
a <- as.data.frame(table(data.questions$familiarWithSI.response.))

ggplot(data=a, aes(x=Var1, y=Freq)) +
  geom_bar(stat="identity")

```
> TODO: Description of B1


## Dependence of SI-familiarity on scientific domains

```{r echo=FALSE}
b1.shapiro <- shapiro.test(data$familiarWithSI.response.)
b1.barlett <- bartlett.test(data=data, familiarWithSI.response. ~ domain)
b1.kruswal <- kruskal.test(data=data, familiarWithSI.response. ~ domain)
b1.pwilcox <- pairwise.wilcox.test(data$familiarWithSI.response.,
                                   data$domain,
                                   mu = 0,
                                   alt = "two.sided",
                                   conf.int = T,
                                   conf.level = 0.95,
                                   paired = F,
                                   correct = T,
                                   p.adjust="bonferroni" )

```

The majority of the respondents indicated their low familiarity with SI, approximately %32 of the respondents selected the lowest level of SI-Familiarity (indicated with 0) and only %16 percent of the respondents selected a value equal or greater than 7. 

One of the literature-driven assumptions about the SI-familiarity was that [H] *the SI-Familiarity depends on the scientific domain*. The hypothesis is motivated by the wide-spread perspective especially on the SSH fields to be more aware of the SI aspect in research. 

The results of the study shows a statistically significant difference between the 3 main scientific domains in terms of SI-Familiarity (Kruskal-Wallis [K-W] rank sum test p-value < 0.05). However, as Figure \@ref(type:B1-boxplot) also visualises the domains Mathematics, Natural-, & Engineering Sciences and Biology & Medicine are statistically not significantly different from each other while Social Sciences and Humanities (SSH) show a stat. significant difference to both of the other domains ^[Results of the pairwise comparisons using Wilcoxon rank sum test with continuity correction with Bonferonni p-value adjustment yields a p-value greater than 0.05 for Mathematics, Natural-, & Engineering Sciences. SSH, however, associated with p-values significantly smaller than 0.05 with both of the other domains]. 


```{r B1-boxplot, echo=FALSE, fig.width=12, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
b1domain.df <-data.frame(familiarWithSI = data$familiarWithSI.response.,
                         domain =  data$domain)

b1domain.df$familiarWithSI <- as.numeric(b1domain.df$familiarWithSI)
b1domain.df %>% 
  gather(key="domain", value="familiarWithSI") %>%
  ggplot( aes(x=familiarWithSI, y=domain, fill=domain),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ")+
  theme_light() + 
  theme(axis.text.y=element_blank())+ scale_fill_discrete(name = "Domain") + xlab("Familiarity with SI") + scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Domain") +
  scale_x_continuous(breaks = seq(0,10,2))  

```

# Intention & Agency

## D1: Motivation

```{r echo=FALSE, fig.width=16, fig.height=4 , fig.align='center', dev='CairoSVG'}
d1.df_named <- d1.df
names(d1.df_named) <- c(
  motivation.pheno. = "better understand a natural, technical, economic, or social phenomenon?",
  motivation.prob. = "directly address a natural, technical, economic, or social problem?",
  motivation.welfare. = "improve the human condition/welfare (outside academia)?"

)
d1_items_likert <- 
  #round(d1.df) %>%
  d1.df_named %>%
  mutate_all(likert_recode) %>%
  likert()

mot_likert <- likert_plot(d1_items_likert, h=FALSE, c=c(1,3,5)) + ggtitle("When you designed your project, to what degree were you motivated to â€¦")
mot_likert + theme( axis.text.y = element_text( 
                         size=g_tick_size_side), axis.text.x = element_text(
                         size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) 
```


```{r}
likert_recode_new <- function(x) {
  y <- ifelse(is.na(x), NA,
              ifelse(x <= 3, 0,
                     ifelse(x > 3 & x <7, 1,
                            ifelse(x >= 7, 2, " "))))
  
  y <- factor(y, levels = c("0...not at all - 3", "4 - 6", "7 - 10...fully"))
  
  return(y)
}
d1.welfare_rec <- likert_recode(feat_df.num$motivation.welfare.)
#cor(as.numeric(d1.welfare_rec), feat_df.num$impactTargetGroup.pub., use = "pairwise.complete.obs", "spearman")
cor.test(as.numeric(d1.welfare_rec), feat_df.num$impactTargetGroup.civsoc., use = "pairwise.complete.obs", method = "spearman")
```

```{r D1G1-boxplot, echo=FALSE, fig.width=12, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
dg_df <- as.data.frame(cbind(d1.welfare_rec,
                             feat_df.num$impactTargetGroup.pub., 
                             feat_df.num$impactTargetGroup.civsoc.,
                             feat_df.num$impactTargetGroup.socgr.
                             )
                       )
dg_df$d1.welfare_rec <- likert_recode(feat_df.num$motivation.welfare.)

a <- dg_df[, c(1,2)] %>% 
  filter(!is.na(d1.welfare_rec)) %>%
  gather(key="V2", value="d1.welfare_rec") %>%
  ggplot(aes(x=V2, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y=element_blank(), legend.position = "none") +
  scale_fill_discrete(name = "Motivation to improve human condition") + 
  xlab("contributed to new or better services, products, processes, or ways of doing things that were targeted towards general population") + 
  scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Motivation to improve human condition")

b <- dg_df[, c(1,3)] %>% 
  filter(!is.na(d1.welfare_rec)) %>%
  gather(key="V3", value="d1.welfare_rec") %>%
  ggplot(aes(x=V3, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y=element_blank(), legend.position = "none") +
  scale_fill_discrete(name = "Motivation to improve human condition") + 
  xlab("contributed to new or better services, products, processes, or ways of doing things that were targeted towards specific social groups (e.g. women/men/non-binary, youth/elderly; migrants; or minorities/indigenous people)") + 
  scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Motivation to improve human condition")

c <- dg_df[, c(1,4)] %>% 
  filter(!is.na(d1.welfare_rec)) %>%
  gather(key="V4", value="d1.welfare_rec") %>%
  ggplot(aes(x=V4, y=d1.welfare_rec, fill=d1.welfare_rec),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme(axis.text.y=element_blank()) +
  scale_fill_discrete(name = "Motivation to improve human condition") + 
  xlab("contributed to new or better services, products, processes, or ways of doing things that were targeted towards NGOs, advocacy or other civil society groups") + 
  scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Motivation to improve human condition")

a+b+c

```


## D2: Intention &amp; Agency &ndash; Impulses from the Non-academic World

###### *Addressing a specific problem* ... 

```{r, echo=FALSE, fig.height=5}
data$benefitForNonAcademy[is.na(data$benefitForNonAcademy)] <- 0 
data$benefitForNonAcademy <- factor(data$benefitForNonAcademy, exclude=NA)

benef <- as.data.frame(table(data$benefitForNonAcademy))
benef$Var1 <- c( "No", "To a minor extent", "To a major extent")

g <- ggplot(benef, aes(x=Var1, y=Freq))
# Number of cars in each class:

g + 
  geom_col(fill="#D32F49") + 
  theme_light() +
   theme( axis.text.y = element_text( 
                         size=g_tick_size_side), axis.text.x = element_text(
                         size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) + geom_text(aes(label=Freq), vjust=1.6, color="white", size=5) +
scale_x_discrete("") + 
  scale_y_continuous("count") 
  
```

<!-- TODO: Describe D2 -->

Our hypotheses derived from the literature research includes 2 main assumptions:

* (h_1) The rate of non-academic impulse for research differs between scientific fields.


```{r D2-boxplot, echo=FALSE, fig.width=12, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
d2domain.df <-data.frame(benefitForNonAcademy = feat_df.num$benefitForNonAcademy,
                         domain =  data$domain)

#d2domain.df$benefitForNonAcademy <- as.numeric(1domain.df$familiarWithSI)
d2domain.df %>% 
  gather(key="domain", value="benefitForNonAcademy") %>%
  ggplot( aes(x=benefitForNonAcademy, y=domain, fill=domain),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ")+
  theme_light() + 
  theme(axis.text.y=element_blank())+ scale_fill_discrete(name = "Domain") + xlab("Benefit for non-academy") + scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Domain") +
  scale_x_continuous(breaks = seq(0,10,2))  

```
```{r echo=FALSE}
data$benefitForNonAcademy <- as.numeric(data$benefitForNonAcademy)
d2.shapiro <- shapiro.test(as.numeric(data$benefitForNonAcademy))
d2.barlett <- bartlett.test(data=data, benefitForNonAcademy ~ domain)
d2.kruswal <- kruskal.test(data=data, benefitForNonAcademy ~ domain)
d2.pwilcox <- pairwise.wilcox.test(data$benefitForNonAcademy,
                                   data$domain,
                                   mu = 0,
                                   alt = "two.sided",
                                   conf.int = T,
                                   conf.level = 0.95,
                                   paired = F,
                                   correct = T,
                                   p.adjust="bonferroni" )

```

The deliberative approach to benefit for non-academic society shows statistically significant difference between different domains (Kruskal-Wallis Test p-value < 0.05), however while there is a stat. significant difference between SSH and Physical Sciences as well as between Bology & Medicine and Physical Sciences, there is no stat. difference between SSH and Biology & Medicine.  

* (h_2) Impulses from non-academic world correlates with the nature of involvement of societal actors in the project.

The nature of involvement of specific groups indicate how far the involvement of those were in the project (for a detailed analysis of the variable see *Nature of Involvement* under *Actors & Networks*), including the options *No*, *To a minor extent* and *To a major extent*. 

```{r D2E2-boxplot, echo=FALSE, fig.width=12, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
d2domain.df <- as.data.frame(cbind(d2domain.df,
      citiz = feat_df.num$natureOfInvolvement.citiz.,
      civsoc = feat_df.num$natureOfInvolvement.civsoc.,
      welfare = feat_df.num$natureOfInvolvement.welfare.
))
data$natureOfInvolvement.citiz.

d2domain.df$benefitForNonAcademy <- likert_recode2(d2domain.df$benefitForNonAcademy)
# d2domain.df$citiz <- likert_recode3(d2domain.df$citiz)
# d2domain.df$civsoc <- likert_recode3(d2domain.df$civsoc)
# d2domain.df$welfare <- likert_recode3(d2domain.df$welfare)

a <- d2domain.df[, c(1,3)] %>% 
  filter(!is.na(benefitForNonAcademy)) %>%
  filter(!is.na(citiz)) %>%
  gather(key="citiz", value="benefitForNonAcademy") %>%
  ggplot(aes(x=citiz, y=benefitForNonAcademy, fill=benefitForNonAcademy),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme( legend.position = "none") +
  scale_fill_discrete(name = "Aiming for a non-academic benefit") + 
  xlab("Nature of Involvement of Citizens") + 
  scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Aiming for a non-academic benefit") + 
  coord_flip() +
  # geom_dotplot(binaxis='y', 
  #                  stackdir = "centerwhole", 
  #                  binwidth = 1/20,
  #                  dotsize = 1,
  #                  aes(fill = benefitForNonAcademy)
  # ) + 
  scale_x_discrete(limits = c("No Involvement",
  "Contributory",
  "Collaboratively",
  "Co-created"
  )) 


b <- d2domain.df[, c(1,4)] %>% 
  filter(!is.na(benefitForNonAcademy)) %>%
  filter(!is.na(civsoc)) %>%
  gather(key="civsoc", value="benefitForNonAcademy") %>%
  ggplot(aes(x=civsoc, y=benefitForNonAcademy, fill=benefitForNonAcademy),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ") +
  coord_flip() +
  theme_light() +
  theme(axis.text.y=element_blank(), legend.position = "none") +
  scale_fill_discrete(name = "Aiming for a non-academic benefit") + 
  xlab("Nature of Involvement of Civil Society Organisations, NGOs") + 
  scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Aiming for a non-academic benefit")


c <- d2domain.df[, c(1,5)] %>% 
  filter(!is.na(benefitForNonAcademy)) %>%
  filter(!is.na(welfare)) %>%
  gather(key="welfare", value="benefitForNonAcademy") %>%
  ggplot(aes(x=welfare, y=benefitForNonAcademy, fill=benefitForNonAcademy),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ") +
  coord_flip() +
  theme_light() +
  theme(axis.text.y=element_blank(), legend.position = "none") +
  scale_fill_discrete(name = "Aiming for a non-academic benefit") + 
  xlab("Nature of Involvement of representatives of welfare -, education institutions") + 
  scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Aiming for a non-academic benefit")

a+b+c
```
```{r}
cor.test(as.numeric(d2domain.df$benefitForNonAcademy), d2domain.df$civsoc, use = "pairwise.complete.obs", method = "spearman")
```
Directly aiming to benefit society expected to correlate relatively higher with the level of participation of the societal actors. However according to the survey results the correlation between the nature of involvement of the citizens as well as civil society organisations and the deliberation to benefit society is very weak (spearman's $\rho$ ~0.15 and ~0.05 respectively). The correlation between the welfare organisations & NGOs with the same deliberative motivation is the only statistically significant one, however also this relation is a weak positive correlation (spearman's $\rho$ ~0.3).

## D3: Direct benefit for the general population or a specific non-academic group

```{r echo=FALSE, fig.height=5}
d3.df_colsum <- as.data.frame(colSums(d3.df))
rownames(d3.df_colsum) <- c("societal",
"economic",
"ecological/natural",
"medical/health",
"technical")

g <- ggplot(d3.df_colsum, aes(x=rownames(d3.df_colsum), y=`colSums(d3.df)`))
# Number of cars in each class:
g + geom_col(fill="#338BBE") + 
  theme_light() + theme(axis.text.x = element_text()) + 
  scale_x_discrete("") + 
  scale_y_continuous("count") + geom_text(aes(label=`colSums(d3.df)`), vjust=1.6, color="white", size=5) + theme( axis.text.y = element_text( 
                         size=g_tick_size_side), axis.text.x = element_text(
                         size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) 
```






# Actors & Networks

## E1/E2: Transdisciplinary Aspects: Inter-/Transdisciplinary Involvement
 
```{r E1-Involvement, fig.width=16, fig.height=5, fig.align = 'center',echo=FALSE, dev='svg'}

e1.df_named <- e1.df 
names(e1.df_named) <- c(
  groupsInvolved.res. = "researchers from other disciplines",
groupsInvolved.busi.   = "company/business representatives (incl. farmers)",
groupsInvolved.civsoc.= "representatives of NGOs, advocacy or other civil society groups",
groupsInvolved.policy.= "policy makers, public administrations, representatives from governmental agencies",
groupsInvolved.citiz.= "individual citizens (e.g. as beneficiaries, customers, or concerned persons)",
groupsInvolved.media.= "media representatives (traditional media, digital media (e.g. bloggers), journalists, community-led media, etc.)",
groupsInvolved.welfare.= "representatives from welfare- or education-providing institutions (such as schools, kindergartens, hospitals, or care centres)"
)

e1_items_likert <- 
  #round(d1.df) %>%
  e1.df_named %>%
  mutate_all(likert_recode2) %>%
  likert()



trans_likert <- likert_plot(e1_items_likert, h=FALSE, c=c(1,3,5)) + ggtitle("In your research processes, did you actively involve one or more of the following groups?") + theme(axis.text=element_text(size=13))
trans_likert + theme( axis.text.y = element_text( 
                         size=g_tick_size_side), axis.text.x = element_text(
                         size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) 
```

Interdisciplinary involvement is more common among the SNF funded projects, 41% of the respondents note that the involvement of academicians from other disciplines were quite central to their specific project. Transdisciplinary involvement has been measured under different categories that indicate different type of societal actors and groups in the survey. Although not as central as the interdisciplinary involvement different types of transdisciplinary engagement constitute a noteworthy part of the research projects. 


+ similar across different groups in terms of extent and depth of involvement (*marginal* / *central*)



```{r E2-Nature, fig.width=16, fig.height=5, echo=FALSE, dev='svg', fig.align='center'}

e2.df_named <- e2.df 
names(e2.df_named) <- c(
  natureOfInvolvement.res. = "researchers from other disciplines",
natureOfInvolvement.busi.   = "company/business representatives (incl. farmers)",
natureOfInvolvement.civsoc.= "representatives of NGOs, advocacy or other civil society groups",
natureOfInvolvement.policy.= "policy makers, public administrations, representatives from governmental agencies",
natureOfInvolvement.citiz.= "individual citizens (e.g. as beneficiaries, customers, or concerned persons)",
natureOfInvolvement.media.= "media representatives (traditional media, digital media (e.g. bloggers), journalists, community-led media, etc.)",
natureOfInvolvement.welfare.= "representatives from welfare- or education-providing institutions (such as schools, kindergartens, hospitals, or care centres)"
)

e2.df_named <- e2.df_named[, 2: ncol(e2.df_named)]


e2_items_likert <- 
  #round(d1.df) %>%
  e2.df_named %>%
  mutate_all(likert_recode4) %>%
  likert()



nature_likert <- likert_plot(e2_items_likert, h=FALSE, c = c(2:5)) + ggtitle("What was the nature of involvement of those groups?") + theme(axis.text=element_text(size=13))
nature_likert+ theme( axis.text.y = element_text( 
                         size=g_tick_size_side), axis.text.x = element_text(
                         size=g_tick_size_side), axis.title=element_text(size=g_tick_size_side), legend.text=element_text(size=g_tick_size_side)) 

```



* Transdisciplinary involvement mostly *consultative* or *contributory* in nature.
* *Collaborative* processes more likely in projects where *welfare-/education providing institutions* or *company/ business representatives* are relevant



```{r}
he_df <- as.data.frame(cbind(feat_df.num$groupsInvolved.citiz.,
                             feat_df.num$familiarWithSI.response.
  )
)

cor.test( he_df$V1, he_df$V2, method = "spearman", use = "complete.obs")
```


* There is a although relatively weak (~0.35) statistically significant positive correlation between SI-Familiarity and involvement of citizens in the research project.

```{r E1B1-boxplot, echo=FALSE, fig.width=12, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
he_df$V1 <- likert_recode2(he_df$V1)
he_df %>% 
  filter(!is.na(V1)) %>%
  gather(key="V2", value="V1") %>%
  ggplot( aes(x=V2, y=V1, fill=V1),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ")+
  theme_light() + 
   theme(axis.text.y=element_blank())+ scale_fill_discrete(name = "Involvement of Citizens") + xlab("Familiarity with SI") + scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB"), name="Involvement of Citizens")


```



The type of involvement of the societal actors is also important to analyse the SI-relevant characteristics of the projects. Transdisciplinary approaches are often applied to capitalize on the ability of multiplicity of non-academic actors to address a specific issue. Therefore; we expect with the higher levels of involvement of societal actors a transdisciplinary project to,  
H_1:  explore issues previously not (widely) known in society, and secondly,
H_2: also aim to design/offer an up-/out-/deep-scalable solution.


```{r E2G1-boxplot, echo=FALSE, fig.width=12, fig.height=4, dev='svg', fig.retina=2, fig.align='center'}
e2domain.df <- as.data.frame(cbind(
      unknown =feat_df.num$Impactstatements.unknown.,
      citiz = e2.df_named$`individual citizens (e.g. as beneficiaries, customers, or concerned persons)`,
      civsoc = e2.df_named$`representatives of NGOs, advocacy or other civil society groups`,
      welfare = e2.df_named$`representatives from welfare- or education-providing institutions (such as schools, kindergartens, hospitals, or care centres)`
))

# d2domain.df$benefitForNonAcademy <- likert_recode2(d2domain.df$benefitForNonAcademy)
e2domain.df$citiz <- likert_recode4(e2domain.df$citiz)
e2domain.df$civsoc <- likert_recode4(e2domain.df$civsoc)
e2domain.df$welfare <- likert_recode4(e2domain.df$welfare)

a <- e2domain.df[, c(1,2)] %>% 
  filter(!is.na(unknown)) %>%
  filter(!is.na(citiz)) %>%
  gather(key="unknown", value="citiz") %>%
  ggplot(aes(x=unknown, y=citiz, fill=citiz),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme( legend.position = "none") +
  scale_fill_discrete(name = "Nature of involvement (citizens)") + 
  xlab("Adressed an previously unknown issue") + 
  scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB", "#00AFBB"), name="Nature of involvement (citizens)") + 
  coord_flip() +
  # geom_dotplot(binaxis='y', 
  #                  stackdir = "centerwhole", 
  #                  binwidth = 1/20,
  #                  dotsize = 1,
  #                  aes(fill = benefitForNonAcademy)
  # ) + 
  scale_y_discrete(limits = c(
  "Consultative",
  "Contributory",
  "Collaboratively",
  "Co-created"
  )) 


b <- e2domain.df[, c(1,3)] %>% 
  filter(!is.na(unknown)) %>%
  filter(!is.na(civsoc)) %>%
  gather(key="unknown", value="civsoc") %>%
  ggplot(aes(x=unknown, y=civsoc, fill=civsoc),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme( legend.position = "none") +
  scale_fill_discrete(name = "Nature of involvement (civil soc. orgs & NGOs)") + 
  xlab("Adressed an previously unknown issue") + 
  scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB", "#00AFBB"), name="Nature of involvement (civil soc. orgs & NGOs)") + 
  coord_flip() +
  scale_y_discrete(limits = c(
  "Consultative",
  "Contributory",
  "Collaboratively",
  "Co-created"
  )) 


c <- e2domain.df[, c(1,4)] %>% 
  filter(!is.na(unknown)) %>%
  filter(!is.na(welfare)) %>%
  gather(key="unknown", value="welfare") %>%
  ggplot(aes(x=unknown, y=welfare, fill=welfare),  show.legend = FALSE) +
    geom_boxplot() +
  ylab(" ") +
  theme_light() +
  theme( legend.position = "none") +
  scale_fill_discrete(name = "Nature of involvement (representatives of welfare-, education orgs)") + 
  xlab("Adressed an previously unknown issue") + 
  scale_fill_manual(values=c("#FC4E07", "#E7B800", "#00AFBB", "#00AFBB"), name="Nature of involvement (representatives of welfare-, education orgs)") + 
  coord_flip() +
  scale_y_discrete(limits = c(
  "Consultative",
  "Contributory",
  "Collaboratively",
  "Co-created"
  )) 

a+b+c
```



```{r}
cor.test(as.numeric(e2domain.df$welfare), e2domain.df$unknown, use = "pairwise.complete.obs", method = "spearman")
```






















































---

# Notes

* Considering most of the variables are not normally distributed non parametric tests are returning statistically more robust outcomes. 